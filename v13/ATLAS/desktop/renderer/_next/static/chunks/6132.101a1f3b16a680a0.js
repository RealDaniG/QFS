"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6132],{92934:function(e,t,a){a.d(t,{Z:function(){return r}});let r=(0,a(79205).Z)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},46132:function(e,t,a){a.r(t),a.d(t,{default:function(){return x}});var r=a(57437),n=a(2265),s=a(27515),o=a(71837);class i{static getInstance(){return i.instance||(i.instance=new i),i.instance}async getProposals(e){try{let t=await (0,o._)("/api/v18/governance/proposals".concat(e?"?status=".concat(e):""));if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));return(await t.json()).map(e=>({id:e.id,title:e.title,description:e.description,creator:e.creator,createdAt:e.created_at?1e3*e.created_at:Date.now(),status:e.status,votesFor:e.votes_for||0,votesAgainst:e.votes_against||0}))}catch(e){return console.error("Failed to fetch proposals:",e),[]}}async getProposal(e){try{return(await this.getProposals()).find(t=>t.id===e)||null}catch(e){return console.error("Failed to fetch proposal:",e),null}}async createProposal(e,t,a){return""}async vote(e,t,a){let r=await (0,o._)("/api/v18/governance/vote",{method:"POST",body:JSON.stringify({proposalId:e,voter:t,choice:a})});if(!r.ok)throw Error("Failed to vote: ".concat(r.statusText));let n=await r.json();if("voted"!==n.status)throw Error(n.message||"Vote failed")}constructor(){}}var l=a(79820),c=a(12381),d=a(69174),u=a(7204),p=a(17168),f=a(79205);let v=(0,f.Z)("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),m=(0,f.Z)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var h=a(92934);function x(){let{did:e}=(0,s.a)(),[t,a]=(0,n.useState)([]),[o,l]=(0,n.useState)(!0),d=i.getInstance();(0,n.useEffect)(()=>{u()},[]);let u=async()=>{l(!0);try{let e=await d.getProposals();a(e)}catch(e){console.error(e)}finally{l(!1)}},f=async(t,a)=>{if(e)try{await d.vote(t,e,a),await u()}catch(e){console.error("Voting failed:",e),alert("Failed to cast vote. Please try again.")}};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold tracking-tight",children:"Protocol Governance"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Vote on parameter updates and policy changes."})]}),(0,r.jsxs)(c.z,{children:[(0,r.jsx)(v,{className:"mr-2 h-4 w-4"}),"New Proposal"]})]}),(0,r.jsxs)(p.mQ,{defaultValue:"active",className:"w-full",children:[(0,r.jsxs)(p.dr,{children:[(0,r.jsx)(p.SP,{value:"active",children:"Active"}),(0,r.jsx)(p.SP,{value:"passed",children:"Passed"}),(0,r.jsx)(p.SP,{value:"rejected",children:"Rejected"})]}),(0,r.jsx)(p.nU,{value:"active",className:"space-y-4 mt-4",children:o?(0,r.jsx)("div",{children:"Loading proposals..."}):0===t.filter(e=>"active"===e.status).length?(0,r.jsx)("div",{className:"text-center py-10 text-muted-foreground",children:"No active proposals"}):t.filter(e=>"active"===e.status).map(t=>(0,r.jsx)(y,{proposal:t,onVote:f,did:e},t.id))}),(0,r.jsx)(p.nU,{value:"passed",className:"mt-4 space-y-4",children:t.filter(e=>"passed"===e.status||"executed"===e.status).map(t=>(0,r.jsx)(y,{proposal:t,onVote:f,did:e,readonly:!0},t.id))}),(0,r.jsx)(p.nU,{value:"rejected",className:"mt-4 space-y-4",children:t.filter(e=>"rejected"===e.status).map(t=>(0,r.jsx)(y,{proposal:t,onVote:f,did:e,readonly:!0},t.id))})]})]})}function y(e){let{proposal:t,onVote:a,did:n,readonly:s=!1}=e,o=t.votesFor+t.votesAgainst,i=o>0?t.votesFor/o*100:0;return(0,r.jsxs)(l.Zb,{children:[(0,r.jsx)(l.Ol,{children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(l.ll,{className:"text-lg",children:t.title}),(0,r.jsxs)(l.SZ,{className:"mt-1",children:["ID: ",t.id.slice(0,12),"... â€¢ Creator: ",t.creator.slice(0,16),"..."]})]}),(0,r.jsx)(d.C,{variant:"active"===t.status?"default":"secondary",children:t.status.toUpperCase()})]})}),(0,r.jsxs)(l.aY,{className:"space-y-4",children:[(0,r.jsx)("p",{className:"text-sm",children:t.description}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsxs)("span",{children:["Current Votes (",o,")"]}),(0,r.jsxs)("span",{children:[i.toFixed(1),"% Yes"]})]}),(0,r.jsx)(u.E,{value:i,className:"h-2"})]})]}),!s&&(0,r.jsxs)(l.eW,{className:"flex justify-end gap-2",children:[(0,r.jsxs)(c.z,{variant:"outline",onClick:()=>a(t.id,"no"),disabled:!n,children:[(0,r.jsx)(m,{className:"mr-2 h-4 w-4 text-red-500"}),"Reject"]}),(0,r.jsxs)(c.z,{onClick:()=>a(t.id,"yes"),disabled:!n,children:[(0,r.jsx)(h.Z,{className:"mr-2 h-4 w-4"}),"Approve"]})]})]})}},79820:function(e,t,a){a.d(t,{Ol:function(){return o},SZ:function(){return l},Zb:function(){return s},aY:function(){return c},eW:function(){return d},ll:function(){return i}});var r=a(57437);a(2265);var n=a(93448);function s(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card",className:(0,n.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...a})}function o(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-header",className:(0,n.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...a})}function i(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-title",className:(0,n.cn)("leading-none font-semibold",t),...a})}function l(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-description",className:(0,n.cn)("text-muted-foreground text-sm",t),...a})}function c(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-content",className:(0,n.cn)("px-6",t),...a})}function d(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-footer",className:(0,n.cn)("flex items-center px-6 [.border-t]:pt-6",t),...a})}},7204:function(e,t,a){a.d(t,{E:function(){return o}});var r=a(57437);a(2265);var n=a(1505),s=a(93448);function o(e){let{className:t,value:a,...o}=e;return(0,r.jsx)(n.fC,{"data-slot":"progress",className:(0,s.cn)("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",t),...o,children:(0,r.jsx)(n.z$,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:"translateX(-".concat(100-(a||0),"%)")}})})}},27515:function(e,t,a){a.d(t,{a:function(){return c}});var r=a(2265),n=a(82957).Buffer;async function s(){let e=await crypto.subtle.generateKey({name:"ECDSA",namedCurve:"P-256"},!0,["sign","verify"]),t=await crypto.subtle.exportKey("raw",e.publicKey),a=await crypto.subtle.exportKey("pkcs8",e.privateKey),r=new Uint8Array(t),s=new Uint8Array(a),o=n.from(r).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"");return{publicKey:r,privateKey:s,did:"did:key:".concat(o)}}let o="atlas_identity_v1";function i(e){if(e.length%2!=0)throw Error("Invalid hex string");let t=new Uint8Array(e.length/2);for(let a=0;a<e.length;a+=2)t[a/2]=parseInt(e.substring(a,a+2),16);return t}function l(e){return Array.from(e).map(e=>e.toString(16).padStart(2,"0")).join("")}function c(){let[e,t]=(0,r.useState)({did:null,privateKey:null,publicKey:null,isAuthenticated:!1,isLoading:!0,error:null});(0,r.useEffect)(()=>{a()},[]);let a=async()=>{try{let e=localStorage.getItem(o);if(e){let a=JSON.parse(e);t({did:a.did,privateKey:i(a.privateKey),publicKey:i(a.publicKey),isAuthenticated:!0,isLoading:!1,error:null})}else{let e=await s(),a={did:e.did,privateKey:l(e.privateKey),publicKey:l(e.publicKey)};localStorage.setItem(o,JSON.stringify(a)),t({did:e.did,privateKey:e.privateKey,publicKey:e.publicKey,isAuthenticated:!0,isLoading:!1,error:null})}}catch(e){console.error("Failed to load identity:",e),t(t=>({...t,isLoading:!1,error:e}))}};return{...e,logout:()=>{localStorage.removeItem(o),t({did:null,privateKey:null,publicKey:null,isAuthenticated:!1,isLoading:!1,error:null})}}}},71837:function(e,t,a){a.d(t,{_:function(){return n}});let r="atlas_session_v1";async function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{auth:a=!0,headers:n={},...s}=t,o=new Headers(n);if(t.body&&!o.has("Content-Type")&&o.set("Content-Type","application/json"),a){let e=localStorage.getItem(r);if(e)try{let t=JSON.parse(e);t.session_token&&o.set("Authorization","Bearer ".concat(t.session_token))}catch(e){console.error("Failed to parse session for auth header",e)}}let i=e.startsWith("http")?e:"".concat("http://localhost:8000").concat(e),l=await fetch(i,{...s,headers:o});return 401===l.status&&a&&(localStorage.removeItem(r),window.dispatchEvent(new Event("atlas-auth-expired"))),l}},1505:function(e,t,a){a.d(t,{z$:function(){return w},fC:function(){return j}});var r=a(2265),n=a(57437);a(54887);var s=a(37053),o=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let a=(0,s.Z8)(`Primitive.${t}`),o=r.forwardRef((e,r)=>{let{asChild:s,...o}=e,i=s?a:t;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,n.jsx)(i,{...o,ref:r})});return o.displayName=`Primitive.${t}`,{...e,[t]:o}},{}),i="Progress",[l,c]=function(e,t=[]){let a=[],s=()=>{let t=a.map(e=>r.createContext(e));return function(a){let n=a?.[e]||t;return r.useMemo(()=>({[`__scope${e}`]:{...a,[e]:n}}),[a,n])}};return s.scopeName=e,[function(t,s){let o=r.createContext(s);o.displayName=t+"Context";let i=a.length;a=[...a,s];let l=t=>{let{scope:a,children:s,...l}=t,c=a?.[e]?.[i]||o,d=r.useMemo(()=>l,Object.values(l));return(0,n.jsx)(c.Provider,{value:d,children:s})};return l.displayName=t+"Provider",[l,function(a,n){let l=n?.[e]?.[i]||o,c=r.useContext(l);if(c)return c;if(void 0!==s)return s;throw Error(`\`${a}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let a=()=>{let a=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let n=a.reduce((t,{useScope:a,scopeName:r})=>{let n=a(e)[`__scope${r}`];return{...t,...n}},{});return r.useMemo(()=>({[`__scope${t.scopeName}`]:n}),[n])}};return a.scopeName=t.scopeName,a}(s,...t)]}(i),[d,u]=l(i),p=r.forwardRef((e,t)=>{var a,r,s,i;let{__scopeProgress:l,value:c=null,max:u,getValueLabel:p=m,...f}=e;(u||0===u)&&!y(u)&&console.error((a="".concat(u),r="Progress","Invalid prop `max` of value `".concat(a,"` supplied to `").concat(r,"`. Only numbers greater than 0 are valid max values. Defaulting to `").concat(100,"`.")));let v=y(u)?u:100;null===c||g(c,v)||console.error((s="".concat(c),i="Progress","Invalid prop `value` of value `".concat(s,"` supplied to `").concat(i,"`. The `value` prop must be:\n  - a positive number\n  - less than the value passed to `max` (or ").concat(100," if no `max` prop is set)\n  - `null` or `undefined` if the progress is indeterminate.\n\nDefaulting to `null`.")));let j=g(c,v)?c:null,w=x(j)?p(j,v):void 0;return(0,n.jsx)(d,{scope:l,value:j,max:v,children:(0,n.jsx)(o.div,{"aria-valuemax":v,"aria-valuemin":0,"aria-valuenow":x(j)?j:void 0,"aria-valuetext":w,role:"progressbar","data-state":h(j,v),"data-value":null!=j?j:void 0,"data-max":v,...f,ref:t})})});p.displayName=i;var f="ProgressIndicator",v=r.forwardRef((e,t)=>{var a;let{__scopeProgress:r,...s}=e,i=u(f,r);return(0,n.jsx)(o.div,{"data-state":h(i.value,i.max),"data-value":null!==(a=i.value)&&void 0!==a?a:void 0,"data-max":i.max,...s,ref:t})});function m(e,t){return"".concat(Math.round(e/t*100),"%")}function h(e,t){return null==e?"indeterminate":e===t?"complete":"loading"}function x(e){return"number"==typeof e}function y(e){return x(e)&&!isNaN(e)&&e>0}function g(e,t){return x(e)&&!isNaN(e)&&e<=t&&e>=0}v.displayName=f;var j=p,w=v}}]);