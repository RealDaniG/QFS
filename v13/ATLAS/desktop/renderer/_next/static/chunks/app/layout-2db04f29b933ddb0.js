(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3185],{48796:function(e,t,a){Promise.resolve().then(a.t.bind(a,2778,23)),Promise.resolve().then(a.bind(a,42185)),Promise.resolve().then(a.bind(a,96878))},42185:function(e,t,a){"use strict";a.d(t,{Providers:function(){return y}});var n=a(57437),s=a(21623),r=a(29827),o=a(2265),i=a(10231),d=a(67872),c=a(64314),l=a(55625);let u=(0,d.vX)({appName:"ATLAS v18",projectId:"v18-atlas-project-id",chains:[c.R,l.F],ssr:!0});a(64299);var h=a(64707),f=a(99778);class m{async isAvailable(){return!!(window.ethereum&&window.ethereum.isMetaMask)}async connect(){if(!await this.isAvailable())throw Error("MetaMask is not installed");let e=await window.ethereum.request({method:"eth_requestAccounts"}),t=await window.ethereum.request({method:"eth_chainId"});return{address:e[0],chainId:parseInt(t,16),provider:"metamask"}}async disconnect(){}async signMessage(e){let t=await this.getAddress();return await window.ethereum.request({method:"personal_sign",params:[e,t]})}async signTypedData(e){let t=await this.getAddress();return await window.ethereum.request({method:"eth_signTypedData_v4",params:[t,JSON.stringify(e)]})}async getAddress(){let e=await window.ethereum.request({method:"eth_accounts"});if(!e||0===e.length)throw Error("No account connected");return e[0]}async getChainId(){return parseInt(await window.ethereum.request({method:"eth_chainId"}),16)}onAccountsChanged(e){window.ethereum&&window.ethereum.on("accountsChanged",e)}onChainChanged(e){window.ethereum&&window.ethereum.on("chainChanged",t=>{e(parseInt(t,16))})}constructor(){this.id="metamask",this.name="MetaMask",this.icon="/icons/metamask.svg"}}class p{async isAvailable(){var e;return!!(null===(e=window.ethereum)||void 0===e?void 0:e.isRainbow)}async connect(){if(!await this.isAvailable())throw Error("Rainbow is not installed");let e=await window.ethereum.request({method:"eth_requestAccounts"}),t=await window.ethereum.request({method:"eth_chainId"});return{address:e[0],chainId:parseInt(t,16),provider:"rainbow"}}async disconnect(){}async signMessage(e){let t=await this.getAddress();return await window.ethereum.request({method:"personal_sign",params:[e,t]})}async signTypedData(e){let t=await this.getAddress();return await window.ethereum.request({method:"eth_signTypedData_v4",params:[t,JSON.stringify(e)]})}async getAddress(){let e=await window.ethereum.request({method:"eth_accounts"});if(!e||0===e.length)throw Error("No account connected");return e[0]}async getChainId(){return parseInt(await window.ethereum.request({method:"eth_chainId"}),16)}onAccountsChanged(e){window.ethereum&&window.ethereum.on("accountsChanged",e)}onChainChanged(e){window.ethereum&&window.ethereum.on("chainChanged",t=>{e(parseInt(t,16))})}constructor(){this.id="rainbow",this.name="Rainbow",this.icon="/icons/rainbow.svg"}}let w=(0,o.createContext)(null);function g(e){let{children:t}=e,[a,s]=(0,o.useState)([]),[r,i]=(0,o.useState)(null),[d,c]=(0,o.useState)(null),[l,u]=(0,o.useState)(!1),[g,v]=(0,o.useState)(null),{address:y,isConnected:x,connector:S}=(0,h.m)(),{disconnect:b}=(0,f.q)();(0,o.useEffect)(()=>{if(x&&y){if((null==d?void 0:d.address)!==y){var e;let t=(null==S?void 0:null===(e=S.name)||void 0===e?void 0:e.toLowerCase())||"injected";c({address:y,chainId:1,provider:t.includes("metamask")?"metamask":t.includes("rainbow")?"rainbow":"walletconnect"})}}else!x&&d&&c(null)},[x,y,S,d]),(0,o.useEffect)(()=>{(async()=>{let e=new m,t=new p,a=[];a.push(e),a.push(t),s(a)})()},[]);let N=async e=>{u(!0),v(null);try{let t=a.find(t=>t.id===e);if(!t)throw Error("Adapter not found");if(!await t.isAvailable())throw Error("".concat(t.name," is not installed or detected."));let n=await t.connect();i(t),c(n)}catch(e){console.error("Wallet Connection Error:",e),v(e.message||"Failed to connect wallet")}finally{u(!1)}},A=async()=>{if(r)try{await r.disconnect()}catch(e){console.error("Disconnect error",e)}i(null),c(null)};return(0,n.jsx)(w.Provider,{value:{adapters:a,activeAdapter:r,session:d,isConnecting:l,error:g,connect:N,disconnect:A},children:t})}var v=a(50262);function y(e){let{children:t}=e,[a,c]=(0,o.useState)(!1),[l]=(0,o.useState)(()=>new s.S({defaultOptions:{queries:{staleTime:6e4,gcTime:3e5,refetchOnWindowFocus:!1,retry:1}}}));return(0,o.useEffect)(()=>{c(!0)},[]),(0,n.jsx)(i.F,{config:u,children:(0,n.jsx)(r.aH,{client:l,children:(0,n.jsx)(d.pj,{children:(0,n.jsx)(g,{children:(0,n.jsx)(v.G,{children:t})})})})})}},96878:function(e,t,a){"use strict";a.d(t,{Toaster:function(){return A}});var n=a(57437),s=a(2265);let r=0,o=new Map,i=e=>{if(o.has(e))return;let t=setTimeout(()=>{o.delete(e),u({type:"REMOVE_TOAST",toastId:e})},1e6);o.set(e,t)},d=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?i(a):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},c=[],l={toasts:[]};function u(e){l=d(l,e),c.forEach(e=>{e(l)})}function h(e){let{...t}=e,a=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),n=()=>u({type:"DISMISS_TOAST",toastId:a});return u({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||n()}}}),{id:a,dismiss:n,update:e=>u({type:"UPDATE_TOAST",toast:{...e,id:a}})}}var f=a(41915),m=a(90535),p=a(32489),w=a(93448);let g=f.zt,v=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(f.l_,{ref:t,className:(0,w.cn)("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",a),...s})});v.displayName=f.l_.displayName;let y=(0,m.j)("group pointer-events-auto relative flex w-full items-center justify-between space-x-2 overflow-hidden rounded-md border p-4 pr-6 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),x=s.forwardRef((e,t)=>{let{className:a,variant:s,...r}=e;return(0,n.jsx)(f.fC,{ref:t,className:(0,w.cn)(y({variant:s}),a),...r})});x.displayName=f.fC.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(f.aU,{ref:t,className:(0,w.cn)("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium transition-colors hover:bg-secondary focus:outline-none focus:ring-1 focus:ring-ring disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",a),...s})}).displayName=f.aU.displayName;let S=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(f.x8,{ref:t,className:(0,w.cn)("absolute right-1 top-1 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-1 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",a),"toast-close":"",...s,children:(0,n.jsx)(p.Z,{className:"h-4 w-4"})})});S.displayName=f.x8.displayName;let b=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(f.Dx,{ref:t,className:(0,w.cn)("text-sm font-semibold [&+div]:text-xs",a),...s})});b.displayName=f.Dx.displayName;let N=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(f.dk,{ref:t,className:(0,w.cn)("text-sm opacity-90",a),...s})});function A(){let{toasts:e}=function(){let[e,t]=s.useState(l);return s.useEffect(()=>(c.push(t),()=>{let e=c.indexOf(t);e>-1&&c.splice(e,1)}),[e]),{...e,toast:h,dismiss:e=>u({type:"DISMISS_TOAST",toastId:e})}}();return(0,n.jsxs)(g,{children:[e.map(function(e){let{id:t,title:a,description:s,action:r,...o}=e;return(0,n.jsxs)(x,{...o,children:[(0,n.jsxs)("div",{className:"grid gap-1",children:[a&&(0,n.jsx)(b,{children:a}),s&&(0,n.jsx)(N,{children:s})]}),r,(0,n.jsx)(S,{})]},t)}),(0,n.jsx)(v,{})]})}N.displayName=f.dk.displayName},50262:function(e,t,a){"use strict";a.d(t,{G:function(){return d},m:function(){return c}});var n=a(57437),s=a(2265);class r{async start(e){console.log("P2PNode (MOCK): Ready")}async joinSpace(e,t){console.log("P2PNode (MOCK): Joined",e)}async publishToSpace(e,t){console.log("P2PNode (MOCK): Published",e)}async leaveSpace(e){console.log("P2PNode (MOCK): Left",e)}async stop(){console.log("P2PNode (MOCK): Stopped")}getPeerId(){return"mock-peer-id"}getConnectedPeers(){return[]}constructor(){this.node=null,this.messageHandlers=new Map}}var o=a(32038);let i=(0,s.createContext)({node:null,isReady:!1});function d(e){let{children:t}=e,{isAuthenticated:a,address:d}=(0,o.i)(),[c,l]=(0,s.useState)(null),[u,h]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{let e=null,t=async()=>{a&&d&&(console.log("Initializing P2P Node..."),e=new r,await e.start({walletAddress:d,bootstrapPeers:[]}),l(e),h(!0))};return a&&!c&&t(),()=>{e&&(console.log("Stopping P2P Node..."),e.stop())}},[a,d,c]),(0,n.jsx)(i.Provider,{value:{node:c,isReady:u},children:t})}function c(){return(0,s.useContext)(i)}},32038:function(e,t,a){"use strict";a.d(t,{i:function(){return o}});var n=a(64707),s=a(25865),r=a(2265);function o(){let{address:e,isConnected:t}=(0,n.m)(),{signMessageAsync:a}=(0,s.Q)(),[o,i]=(0,r.useState)(!1),[d,c]=(0,r.useState)(!1),[l,u]=(0,r.useState)(null),[h,f]=(0,r.useState)(null);(0,r.useEffect)(()=>{let e=localStorage.getItem("atlas_session");if(e){let t=JSON.parse(e);t.expiresAt>Date.now()/1e3?(f(t),u(t.sessionToken),i(!0)):localStorage.removeItem("atlas_session")}},[]);let m=async()=>{if(e&&t){c(!0);try{let t=await fetch("".concat("http://localhost:8000","/api/auth/challenge"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wallet_address:e})});if(!t.ok)throw Error("Failed to get challenge");let{message:n}=await t.json(),s=await a({message:n}),r=await fetch("http://localhost:8000/api/auth/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wallet_address:e,signature:s,message:n})});if(!r.ok)throw Error("Signature verification failed");let o=await r.json();localStorage.setItem("atlas_session",JSON.stringify(o)),f(o),u(o.sessionToken),i(!0)}catch(e){console.error("Authentication failed:",e),i(!1)}finally{c(!1)}}},p=async()=>{if(h)try{await fetch("http://localhost:8000/api/auth/logout",{method:"POST",headers:{Authorization:"Bearer ".concat(h.sessionToken)}})}catch(e){console.warn("Logout failed on backend",e)}localStorage.removeItem("atlas_session"),f(null),u(null),i(!1)};return{isConnected:t,isAuthenticated:o,isAuthenticating:d,address:e,session:h,sessionToken:l,authenticate:m,triggerAuth:m,logout:p}}},93448:function(e,t,a){"use strict";a.d(t,{cn:function(){return r}});var n=a(61994),s=a(53335);function r(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.m6)((0,n.W)(t))}},2778:function(){}},function(e){e.O(0,[2461,4434,9472,4618,7090,2971,2117,1744],function(){return e(e.s=48796)}),_N_E=e.O()}]);