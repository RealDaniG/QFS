(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8974],{16380:(e,s,t)=>{"use strict";t.d(s,{r:()=>o,G:()=>m});var a=t(95155),r=t(12115),n=t(2145),i=t(26719);class l{async isAvailable(){return!!(window.ethereum&&window.ethereum.isMetaMask)}async connect(){if(!await this.isAvailable())throw Error("MetaMask is not installed");let e=await window.ethereum.request({method:"eth_requestAccounts"}),s=await window.ethereum.request({method:"eth_chainId"});return{address:e[0],chainId:parseInt(s,16),provider:"metamask"}}async disconnect(){}async signMessage(e){let s=await this.getAddress();return await window.ethereum.request({method:"personal_sign",params:[e,s]})}async signTypedData(e){let s=await this.getAddress();return await window.ethereum.request({method:"eth_signTypedData_v4",params:[s,JSON.stringify(e)]})}async getAddress(){let e=await window.ethereum.request({method:"eth_accounts"});if(!e||0===e.length)throw Error("No account connected");return e[0]}async getChainId(){return parseInt(await window.ethereum.request({method:"eth_chainId"}),16)}onAccountsChanged(e){window.ethereum&&window.ethereum.on("accountsChanged",e)}onChainChanged(e){window.ethereum&&window.ethereum.on("chainChanged",s=>{e(parseInt(s,16))})}constructor(){this.id="metamask",this.name="MetaMask",this.icon="/icons/metamask.svg"}}class c{async isAvailable(){var e;return!!(null==(e=window.ethereum)?void 0:e.isRainbow)}async connect(){if(!await this.isAvailable())throw Error("Rainbow is not installed");let e=await window.ethereum.request({method:"eth_requestAccounts"}),s=await window.ethereum.request({method:"eth_chainId"});return{address:e[0],chainId:parseInt(s,16),provider:"rainbow"}}async disconnect(){}async signMessage(e){let s=await this.getAddress();return await window.ethereum.request({method:"personal_sign",params:[e,s]})}async signTypedData(e){let s=await this.getAddress();return await window.ethereum.request({method:"eth_signTypedData_v4",params:[s,JSON.stringify(e)]})}async getAddress(){let e=await window.ethereum.request({method:"eth_accounts"});if(!e||0===e.length)throw Error("No account connected");return e[0]}async getChainId(){return parseInt(await window.ethereum.request({method:"eth_chainId"}),16)}onAccountsChanged(e){window.ethereum&&window.ethereum.on("accountsChanged",e)}onChainChanged(e){window.ethereum&&window.ethereum.on("chainChanged",s=>{e(parseInt(s,16))})}constructor(){this.id="rainbow",this.name="Rainbow",this.icon="/icons/rainbow.svg"}}let d=(0,r.createContext)(null);function o(e){let{children:s}=e,[t,o]=(0,r.useState)([]),[m,x]=(0,r.useState)(null),[u,h]=(0,r.useState)(null),[p,j]=(0,r.useState)(!1),[f,g]=(0,r.useState)(null),{address:v,isConnected:b,connector:N}=(0,n.F)(),{disconnect:w}=(0,i.u)();(0,r.useEffect)(()=>{if(b&&v){if((null==u?void 0:u.address)!==v){var e;let s=(null==N||null==(e=N.name)?void 0:e.toLowerCase())||"injected";h({address:v,chainId:1,provider:s.includes("metamask")?"metamask":s.includes("rainbow")?"rainbow":"walletconnect"})}}else!b&&u&&h(null)},[b,v,N,u]),(0,r.useEffect)(()=>{(async()=>{let e=new l,s=new c,t=[];t.push(e),t.push(s),o(t)})()},[]);let y=async e=>{j(!0),g(null);try{let s=t.find(s=>s.id===e);if(!s)throw Error("Adapter not found");if(!await s.isAvailable())throw Error("".concat(s.name," is not installed or detected."));let a=await s.connect();x(s),h(a)}catch(e){console.error("Wallet Connection Error:",e),g(e.message||"Failed to connect wallet")}finally{j(!1)}},k=async()=>{if(m)try{await m.disconnect()}catch(e){console.error("Disconnect error",e)}x(null),h(null)};return(0,a.jsx)(d.Provider,{value:{adapters:t,activeAdapter:m,session:u,isConnecting:p,error:f,connect:y,disconnect:k},children:s})}function m(){let e=(0,r.useContext)(d);if(!e)throw Error("useWalletAdapter must be used within a WalletProvider");return e}},40033:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>sI});var a=t(95155),r=t(12115),n=t(35695),i=t(32960),l=t(57340),c=t(14541),d=t(81497),o=t(39785),m=t(79397),x=t(5040),u=t(75525),h=t(381),p=t(54416),j=t(74783),f=t(47924),g=t(23861),v=t(99708),b=t(74466),N=t(59434);let w=(0,b.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function y(e){let{className:s,variant:t,size:r,asChild:n=!1,...i}=e,l=n?v.DX:"button";return(0,a.jsx)(l,{"data-slot":"button",className:(0,N.cn)(w({variant:t,size:r,className:s})),...i})}function k(e){let{className:s,type:t,...r}=e;return(0,a.jsx)("input",{type:t,"data-slot":"input",className:(0,N.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",s),...r})}let S=(0,b.F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function A(e){let{className:s,variant:t,asChild:r=!1,...n}=e,i=r?v.DX:"span";return(0,a.jsx)(i,{"data-slot":"badge",className:(0,N.cn)(S({variant:t}),s),...n})}function C(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"card",className:(0,N.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",s),...t})}function F(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"card-header",className:(0,N.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",s),...t})}function _(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"card-title",className:(0,N.cn)("leading-none font-semibold",s),...t})}function E(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"card-description",className:(0,N.cn)("text-muted-foreground text-sm",s),...t})}function I(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"card-content",className:(0,N.cn)("px-6",s),...t})}function D(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"card-footer",className:(0,N.cn)("flex items-center px-6 [.border-t]:pt-6",s),...t})}var L=t(47655);function z(e){let{className:s,children:t,...r}=e;return(0,a.jsxs)(L.bL,{"data-slot":"scroll-area",className:(0,N.cn)("relative",s),...r,children:[(0,a.jsx)(L.LM,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:t}),(0,a.jsx)(T,{}),(0,a.jsx)(L.OK,{})]})}function T(e){let{className:s,orientation:t="vertical",...r}=e;return(0,a.jsx)(L.VM,{"data-slot":"scroll-area-scrollbar",orientation:t,className:(0,N.cn)("flex touch-none p-px transition-colors select-none","vertical"===t&&"h-full w-2.5 border-l border-l-transparent","horizontal"===t&&"h-2.5 flex-col border-t border-t-transparent",s),...r,children:(0,a.jsx)(L.lr,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}var P=t(78513);function R(e){let{className:s,...t}=e;return(0,a.jsx)(P.bL,{"data-slot":"avatar",className:(0,N.cn)("relative flex size-8 shrink-0 overflow-hidden rounded-full",s),...t})}function q(e){let{className:s,...t}=e;return(0,a.jsx)(P._V,{"data-slot":"avatar-image",className:(0,N.cn)("aspect-square size-full",s),...t})}function O(e){let{className:s,...t}=e;return(0,a.jsx)(P.H4,{"data-slot":"avatar-fallback",className:(0,N.cn)("bg-muted flex size-full items-center justify-center rounded-full",s),...t})}var K=t(2145),V=t(99901);function M(){let{address:e,isConnected:s}=(0,K.F)(),{signMessageAsync:t}=(0,V.Y)(),[a,n]=(0,r.useState)(!1),[i,l]=(0,r.useState)(!1),[c,d]=(0,r.useState)(null),[o,m]=(0,r.useState)(null);(0,r.useEffect)(()=>{let e=localStorage.getItem("atlas_session");if(e){let s=JSON.parse(e);s.expiresAt>Date.now()/1e3?(m(s),d(s.sessionToken),n(!0)):localStorage.removeItem("atlas_session")}},[]);let x=async()=>{if(e&&s){l(!0);try{let s=await fetch("http://localhost:8000/api/auth/challenge",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wallet_address:e})});if(!s.ok)throw Error("Failed to get challenge");let{message:a}=await s.json(),r=await t({message:a}),i=await fetch("http://localhost:8000/api/auth/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wallet_address:e,signature:r,message:a})});if(!i.ok)throw Error("Signature verification failed");let l=await i.json();localStorage.setItem("atlas_session",JSON.stringify(l)),m(l),d(l.sessionToken),n(!0)}catch(e){console.error("Authentication failed:",e),n(!1)}finally{l(!1)}}},u=async()=>{if(o)try{await fetch("http://localhost:8000/api/auth/logout",{method:"POST",headers:{Authorization:"Bearer ".concat(o.sessionToken)}})}catch(e){console.warn("Logout failed on backend",e)}localStorage.removeItem("atlas_session"),m(null),d(null),n(!1)};return{isConnected:s,isAuthenticated:a,isAuthenticating:i,address:e,session:o,sessionToken:c,authenticate:x,triggerAuth:x,logout:u}}function U(){let{address:e,isConnected:s,sessionToken:t}=M(),[a,n]=(0,r.useState)(null),[i,l]=(0,r.useState)([]),[c,d]=(0,r.useState)(!0),o=(0,r.useCallback)(async()=>{if(!s||!e||!t)return void d(!1);try{let[e,s]=await Promise.all([fetch("http://localhost:8000/api/wallet/balance",{headers:{Authorization:"Bearer ".concat(t)}}),fetch("http://localhost:8000/api/wallet/transactions",{headers:{Authorization:"Bearer ".concat(t)}})]);if(e.ok&&s.ok){let t=await e.json(),a=await s.json();n({balance:t.balance.FLX,rewards:0,staked:0,currency:"FLX",reputation:0}),l(a.transactions.map(e=>({id:e.id,type:e.type,reason:e.description,amount:e.amount,timestamp:e.timestamp})))}}catch(e){console.error("Failed to refresh treasury in useTreasury hook:",e)}finally{d(!1)}},[e,s,t]);return(0,r.useEffect)(()=>{if(!s||!t){d(!1),n(null),l([]);return}o();let e=setInterval(o,3e4);return()=>clearInterval(e)},[o,s,t]),{balance:a,history:i,isLoading:c,refresh:o}}var G=t(72797);function W(e){let{className:s,...t}=e;return(0,a.jsx)(G.b,{"data-slot":"label",className:(0,N.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",s),...t})}var B=t(14050);function J(e){let{className:s,orientation:t="horizontal",decorative:r=!0,...n}=e;return(0,a.jsx)(B.b,{"data-slot":"separator",decorative:r,orientation:t,className:(0,N.cn)("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",s),...n})}var Q=t(78082);function X(e){let{delayDuration:s=0,...t}=e;return(0,a.jsx)(Q.Kq,{"data-slot":"tooltip-provider",delayDuration:s,...t})}function H(e){let{...s}=e;return(0,a.jsx)(X,{children:(0,a.jsx)(Q.bL,{"data-slot":"tooltip",...s})})}function Y(e){let{...s}=e;return(0,a.jsx)(Q.l9,{"data-slot":"tooltip-trigger",...s})}function Z(e){let{className:s,sideOffset:t=0,children:r,...n}=e;return(0,a.jsx)(Q.ZL,{children:(0,a.jsxs)(Q.UC,{"data-slot":"tooltip-content",sideOffset:t,className:(0,N.cn)("bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",s),...n,children:[r,(0,a.jsx)(Q.i3,{className:"bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}function $(e){var s,t,r,n,i,l,c,d;let{type:o,explanation:m,onClose:x,isLoading:u}=e;if(u)return(0,a.jsxs)(C,{className:"w-full max-w-2xl animate-pulse",children:[(0,a.jsx)(F,{children:(0,a.jsx)("div",{className:"h-6 bg-muted rounded w-1/3"})}),(0,a.jsx)(I,{children:(0,a.jsx)("div",{className:"h-24 bg-muted rounded"})})]});if(!m)return null;let h="reward"===o,p="ranking"===o,j=h?m:null,f=p?m:null,g=(null==j||null==(t=j.breakdown)||null==(s=t.base_reward)?void 0:s.ATR)||(null==j||null==(r=j.base_reward)?void 0:r.ATR),v=(null==j||null==(n=j.breakdown)?void 0:n.bonuses)||(null==j?void 0:j.bonuses),b=(null==j||null==(i=j.breakdown)?void 0:i.caps)||(null==j?void 0:j.caps),N=(null==j||null==(l=j.breakdown)?void 0:l.guards)||(null==j?void 0:j.guards),w=null==f?void 0:f.signals,k=null==f?void 0:f.neighbors,S=(null==(c=m.verification)?void 0:c.hash)||m.explanation_hash||"unknown";return(0,a.jsx)(X,{children:(0,a.jsxs)(C,{className:"w-full max-w-2xl shadow-lg border-2 border-primary/10",children:[(0,a.jsxs)(F,{className:"flex flex-row items-center justify-between bg-muted/20 pb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)(_,{className:"text-lg font-semibold flex items-center gap-2",children:["Explain This: ",h?"Reward":"Ranking"]}),(0,a.jsxs)(A,{variant:"outline",className:"font-mono text-xs",children:["Hash: ",S.slice(0,8),"..."]})]}),x&&(0,a.jsx)(y,{variant:"ghost",size:"sm",onClick:x,className:"hover:bg-destructive/10 hover:text-destructive",children:"✕"})]}),(0,a.jsxs)(I,{className:"space-y-6 pt-6",children:[h&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"bg-muted/30 p-3 rounded-lg",children:[(0,a.jsx)("h4",{className:"font-medium text-sm text-muted-foreground mb-1",children:"Base Reward"}),(0,a.jsx)("div",{className:"text-2xl font-bold font-mono text-primary",children:g})]}),v&&v.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"font-medium text-sm mb-2 flex items-center gap-2",children:["Bonuses ",(0,a.jsx)(A,{variant:"secondary",className:"text-[10px]",children:v.length})]}),(0,a.jsx)("ul",{className:"space-y-2",children:v.map((e,s)=>(0,a.jsxs)("li",{className:"flex justify-between items-center text-sm p-2 rounded hover:bg-muted/50 transition-colors",children:[(0,a.jsx)("span",{className:"font-medium",children:e.label}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"font-mono text-green-600 font-bold",children:e.value}),(0,a.jsxs)(H,{children:[(0,a.jsx)(Y,{children:(0,a.jsx)("span",{className:"text-muted-foreground cursor-help text-xs",children:"Why?"})}),(0,a.jsx)(Z,{children:(0,a.jsx)("p",{children:e.reason})})]})]})]},s))})]}),b&&b.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-sm mb-2 flex items-center gap-2",children:"Caps Applied"}),(0,a.jsx)("ul",{className:"space-y-2",children:b.map((e,s)=>(0,a.jsxs)("li",{className:"flex justify-between items-center text-sm p-2 bg-red-50/50 dark:bg-red-900/10 rounded",children:[(0,a.jsx)("span",{className:"text-destructive/80",children:e.label}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"font-mono text-destructive font-bold",children:e.value}),(0,a.jsxs)(H,{children:[(0,a.jsx)(Y,{children:(0,a.jsx)("span",{className:"text-muted-foreground cursor-help text-xs",children:"Why?"})}),(0,a.jsx)(Z,{children:(0,a.jsx)("p",{children:e.reason})})]})]})]},s))})]}),N&&N.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-sm mb-2",children:"Guard Checks"}),(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:N.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 border rounded text-sm",children:[(0,a.jsx)("span",{children:e.name}),(0,a.jsxs)(H,{children:[(0,a.jsx)(Y,{children:(0,a.jsx)(A,{variant:"pass"===e.result?"outline":"destructive",className:"pass"===e.result?"border-green-500 text-green-600":"",children:e.result.toUpperCase()})}),(0,a.jsx)(Z,{children:(0,a.jsx)("p",{children:e.reason})})]})]},s))})]})]}),p&&(0,a.jsxs)(a.Fragment,{children:[w&&w.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-sm mb-2",children:"Ranking Signals"}),(0,a.jsx)("div",{className:"space-y-3",children:w.map((e,s)=>(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"font-medium",children:e.name}),(0,a.jsxs)("span",{className:"font-mono text-xs text-muted-foreground",children:["W: ",e.weight.toFixed(2)," \xd7 S: ",e.score.toFixed(2)]})]}),(0,a.jsx)("div",{className:"h-2 w-full bg-muted rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-blue-500 transition-all",style:{width:"".concat(100*e.score,"%"),opacity:e.weight}})}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground text-right",children:e.description})]},s))})]}),k&&k.length>0&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("h4",{className:"font-medium text-sm mb-2",children:"Context (Neighbors)"}),(0,a.jsx)("div",{className:"rounded-md border divide-y",children:k.map((e,s)=>(0,a.jsxs)("div",{className:"p-2 flex justify-between text-sm",children:[(0,a.jsx)("span",{children:e.metric}),(0,a.jsxs)("span",{className:"font-mono",children:["Rank #",e.rank," (Val: ",e.value,")"]})]},s))})]})]}),(0,a.jsx)(J,{}),(0,a.jsxs)("div",{className:"text-[10px] text-muted-foreground space-y-1 font-mono",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Source:"}),(0,a.jsx)("span",{children:"Deterministic Replay (Zero-Sim)"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Computed At:"}),(0,a.jsx)("span",{children:m.timestamp||(null==(d=m.metadata)?void 0:d.computed_at)||"Now"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Policy Version:"}),(0,a.jsx)("span",{children:m.policy_version||"unknown"})]})]})]})]})})}var ee=t(23464),es=t(51154),et=t(85339),ea=t(63439);function er(){return(0,a.jsx)("div",{className:"flex flex-col items-end gap-2",children:(0,a.jsx)(ea.pK,{accountStatus:"address",chainStatus:"icon",showBalance:!1})})}function en(){let{isConnected:e}=M(),[s,t]=(0,r.useState)(""),[n,l]=(0,r.useState)(void 0),[c,d]=(0,r.useState)(!1),{data:o,isLoading:m,error:x,refetch:h}=function(e,s){let{isConnected:t,address:a}=M();return(0,i.I)({queryKey:["explainReward",e,s],queryFn:async()=>{let{data:t}=await ee.A.get("/api/explain/reward/".concat(e).concat(s?"?epoch=".concat(s):""),{headers:{"x-atlas-address":a}});return t},enabled:!!e&&t&&!!a,staleTime:6e4})}(s,n);return e?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(C,{children:[(0,a.jsx)(F,{children:(0,a.jsx)(_,{className:"text-lg",children:"Explain Reward (End-to-End Demo)"})}),(0,a.jsxs)(I,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(W,{htmlFor:"walletId",children:"Wallet ID"}),(0,a.jsx)(k,{id:"walletId",value:s,onChange:e=>t(e.target.value),placeholder:"e.g., wallet_123"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(W,{htmlFor:"epoch",children:"Epoch (optional)"}),(0,a.jsx)(k,{id:"epoch",type:"number",value:null!=n?n:"",onChange:e=>l(e.target.value?Number(e.target.value):void 0),placeholder:"e.g., 1"})]})]}),(0,a.jsxs)(y,{onClick:()=>{s.trim()&&(d(!0),h())},disabled:!s.trim()||m,children:[m&&(0,a.jsx)(es.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Explain Reward"]})]})]}),x&&(0,a.jsx)(C,{className:"border-destructive",children:(0,a.jsx)(I,{className:"pt-6",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-destructive",children:[(0,a.jsx)(et.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-sm",children:"Failed to load explanation. Please try again."})]})})}),c&&o&&(0,a.jsx)($,{type:"reward",explanation:{wallet_id:o.wallet_id,user_id:o.wallet_id,reward_event_id:"demo",epoch:o.epoch,timestamp:Date.now(),base_reward:{ATR:o.base},bonuses:o.bonuses,caps:o.caps,guards:o.guards,policy_version:"v18",policy_hash:"demo",total_reward:{ATR:o.total},explanation_hash:o.metadata.replay_hash,reason_codes:[]},onClose:()=>d(!1)})]}):(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)(C,{className:"border-blue-500/30 bg-blue-500/5",children:[(0,a.jsxs)(F,{children:[(0,a.jsxs)(_,{className:"flex items-center gap-2",children:[(0,a.jsx)(u.A,{className:"h-5 w-5 text-blue-600"}),"Reward Explanation Requires Authentication"]}),(0,a.jsx)(E,{children:"Connect your wallet to inspect reward explanations and verify economic calculations."})]}),(0,a.jsxs)(I,{className:"space-y-4",children:[(0,a.jsx)("div",{className:"p-4 bg-background/50 rounded-xl border border-blue-500/20",children:(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"The Explain Reward feature provides deterministic, auditable explanations for all reward calculations in the QFS system. Authentication is required to access this feature."})}),(0,a.jsx)("div",{className:"flex justify-center pt-4",children:(0,a.jsx)(er,{})})]})]})})}function ei(e){let{className:s,...t}=e;return(0,a.jsx)("textarea",{"data-slot":"textarea",className:(0,N.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),...t})}var el=t(30064);function ec(e){let{className:s,...t}=e;return(0,a.jsx)(el.bL,{"data-slot":"tabs",className:(0,N.cn)("flex flex-col gap-2",s),...t})}function ed(e){let{className:s,...t}=e;return(0,a.jsx)(el.B8,{"data-slot":"tabs-list",className:(0,N.cn)("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",s),...t})}function eo(e){let{className:s,...t}=e;return(0,a.jsx)(el.l9,{"data-slot":"tabs-trigger",className:(0,N.cn)("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...t})}function em(e){let{className:s,...t}=e;return(0,a.jsx)(el.UC,{"data-slot":"tabs-content",className:(0,N.cn)("flex-1 outline-none",s),...t})}var ex=t(43433),eu=t(66474),eh=t(5196),ep=t(47863);function ej(e){let{...s}=e;return(0,a.jsx)(ex.bL,{"data-slot":"select",...s})}function ef(e){let{...s}=e;return(0,a.jsx)(ex.WT,{"data-slot":"select-value",...s})}function eg(e){let{className:s,size:t="default",children:r,...n}=e;return(0,a.jsxs)(ex.l9,{"data-slot":"select-trigger","data-size":t,className:(0,N.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...n,children:[r,(0,a.jsx)(ex.In,{asChild:!0,children:(0,a.jsx)(eu.A,{className:"size-4 opacity-50"})})]})}function ev(e){let{className:s,children:t,position:r="popper",...n}=e;return(0,a.jsx)(ex.ZL,{children:(0,a.jsxs)(ex.UC,{"data-slot":"select-content",className:(0,N.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:r,...n,children:[(0,a.jsx)(eN,{}),(0,a.jsx)(ex.LM,{className:(0,N.cn)("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:t}),(0,a.jsx)(ew,{})]})})}function eb(e){let{className:s,children:t,...r}=e;return(0,a.jsxs)(ex.q7,{"data-slot":"select-item",className:(0,N.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",s),...r,children:[(0,a.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,a.jsx)(ex.VF,{children:(0,a.jsx)(eh.A,{className:"size-4"})})}),(0,a.jsx)(ex.p4,{children:t})]})}function eN(e){let{className:s,...t}=e;return(0,a.jsx)(ex.PP,{"data-slot":"select-scroll-up-button",className:(0,N.cn)("flex cursor-default items-center justify-center py-1",s),...t,children:(0,a.jsx)(ep.A,{className:"size-4"})})}function ew(e){let{className:s,...t}=e;return(0,a.jsx)(ex.wn,{"data-slot":"select-scroll-down-button",className:(0,N.cn)("flex cursor-default items-center justify-center py-1",s),...t,children:(0,a.jsx)(eu.A,{className:"size-4"})})}var ey=t(54073);function ek(e){let{className:s,defaultValue:t,value:n,min:i=0,max:l=100,...c}=e,d=r.useMemo(()=>Array.isArray(n)?n:Array.isArray(t)?t:[i,l],[n,t,i,l]);return(0,a.jsxs)(ey.bL,{"data-slot":"slider",defaultValue:t,value:n,min:i,max:l,className:(0,N.cn)("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",s),...c,children:[(0,a.jsx)(ey.CC,{"data-slot":"slider-track",className:(0,N.cn)("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-1.5 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:(0,a.jsx)(ey.Q6,{"data-slot":"slider-range",className:(0,N.cn)("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:d.length},(e,s)=>(0,a.jsx)(ey.zi,{"data-slot":"slider-thumb",className:"border-primary bg-background ring-ring/50 block size-4 shrink-0 rounded-full border shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},s))]})}var eS=t(88216);function eA(e){let{className:s,value:t,...r}=e;return(0,a.jsx)(eS.bL,{"data-slot":"progress",className:(0,N.cn)("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",s),...r,children:(0,a.jsx)(eS.C1,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:"translateX(-".concat(100-(t||0),"%)")}})})}var eC=t(40646),eF=t(14186),e_=t(92657),eE=t(34869),eI=t(32919),eD=t(72713),eL=t(33109),ez=t(71539),eT=t(44134).hp;async function eP(){let e=await crypto.subtle.generateKey({name:"ECDSA",namedCurve:"P-256"},!0,["sign","verify"]),s=await crypto.subtle.exportKey("raw",e.publicKey),t=await crypto.subtle.exportKey("pkcs8",e.privateKey),a=new Uint8Array(s),r=new Uint8Array(t),n=eT.from(a).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"");return{publicKey:a,privateKey:r,did:"did:key:".concat(n)}}var eR=t(77477),eq=t(22938);let eO="atlas_identity_v1";function eK(){let[e,s]=(0,r.useState)({did:null,privateKey:null,publicKey:null,isAuthenticated:!1,isLoading:!0,error:null});(0,r.useEffect)(()=>{t()},[]);let t=async()=>{try{let e=localStorage.getItem(eO);if(e){let t=JSON.parse(e);s({did:t.did,privateKey:(0,eq.s)(t.privateKey,"base16"),publicKey:(0,eq.s)(t.publicKey,"base16"),isAuthenticated:!0,isLoading:!1,error:null})}else{let e=await eP(),t={did:e.did,privateKey:(0,eR.d)(e.privateKey,"base16"),publicKey:(0,eR.d)(e.publicKey,"base16")};localStorage.setItem(eO,JSON.stringify(t)),s({did:e.did,privateKey:e.privateKey,publicKey:e.publicKey,isAuthenticated:!0,isLoading:!1,error:null})}}catch(e){console.error("Failed to load identity:",e),s(s=>({...s,isLoading:!1,error:e}))}};return{...e,logout:()=>{localStorage.removeItem(eO),s({did:null,privateKey:null,publicKey:null,isAuthenticated:!1,isLoading:!1,error:null})}}}class eV{async publishContent(e,s){return this.publish(e,this.did||"anonymous",s)}createDraft(e,s){return{content:e,options:s,draftId:"draft_".concat(Date.now()),timestamp:Date.now()}}async publish(e,s,t){try{if(!e)throw Error("Content cannot be empty");await new Promise(e=>setTimeout(e,800));let s="content_".concat(Date.now(),"_").concat(Math.random().toString(36).slice(2));return{success:!0,contentId:s,timestamp:Date.now()}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error",timestamp:Date.now()}}}async update(e,s,t){try{return{success:!0,contentId:e,timestamp:Date.now()}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error",timestamp:Date.now()}}}async delete(e,s){try{return{success:!0,contentId:e,timestamp:Date.now()}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error",timestamp:Date.now()}}}constructor(e,s){this.privateKey=e,this.did=s}}function eM(e){let{isOpen:s,onClose:t}=e,{isAuthenticated:n,did:i}=eK(),{isConnected:l}=M(),{publish:d,isPublishing:m}=function(){let{privateKey:e,did:s,isAuthenticated:t}=eK(),[a,n]=(0,r.useState)(!1),[i,l]=(0,r.useState)(null),c=(0,r.useMemo)(()=>t&&e&&s?new eV(e,s):null,[t,e,s]);return{publish:(0,r.useCallback)(async(e,s)=>{if(!c)return l(Error("User not authenticated")),null;n(!0),l(null);try{let t={type:"text/plain",communityId:s.communityId,tags:s.tags,visibility:s.visibility||"public"};return await c.publishContent(e,t)}catch(e){return console.error("Publishing failed:",e),l(e),null}finally{n(!1)}},[c]),createDraft:(0,r.useCallback)((e,s)=>c?c.createDraft(e,{type:"text/plain",tags:s.tags,visibility:s.visibility}):null,[c]),isPublishing:a,error:i,isReady:!!c}}(),[x,u]=(0,r.useState)(""),[h,p]=(0,r.useState)(""),[j,f]=(0,r.useState)("public"),[g,v]=(0,r.useState)(!1),[b,w]=(0,r.useState)(""),[S,D]=(0,r.useState)([70]),[L,z]=(0,r.useState)([30]),[T,P]=(0,r.useState)({coherenceScore:0,rewardPotential:0,estimatedReach:0,guardChecks:[{name:"Content Quality",status:"pending",description:"Analyzing content structure and clarity"},{name:"Space Guidelines",status:"pending",description:"Checking against space standards"},{name:"Economic Impact",status:"pending",description:"Evaluating reward distribution"},{name:"Spam Detection",status:"pending",description:"Analyzing for spam patterns"}],projections:{immediateRewards:0,longTermRewards:0,reputationImpact:0,networkEffect:0}}),[R,q]=(0,r.useState)(!1),O=async()=>{if(!l)return void q(!0);if(!x.trim())return;q(!1);let e=h.split(",").map(e=>e.trim()).filter(Boolean),s=await d(x,{visibility:j,tags:e});s?(console.log("Published:",s),u(""),p(""),q(!1),t()):console.error("Publish failed")},K=e=>{switch(e){case"pass":return(0,a.jsx)(eC.A,{className:"h-4 w-4 text-green-500"});case"warning":return(0,a.jsx)(et.A,{className:"h-4 w-4 text-yellow-500"});case"fail":return(0,a.jsx)(et.A,{className:"h-4 w-4 text-red-500"});default:return(0,a.jsx)(eF.A,{className:"h-4 w-4 text-gray-400"})}};return s?(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)(C,{className:"w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[(0,a.jsx)(F,{className:"border-b",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(_,{children:"Create Content"}),(0,a.jsx)(E,{children:"Every action is transparent and economically accountable"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(y,{variant:"outline",size:"sm",onClick:()=>v(!g),children:[(0,a.jsx)(e_.A,{className:"h-4 w-4 mr-1"}),g?"Hide":"Show"," Economics"]}),(0,a.jsx)(y,{variant:"ghost",size:"sm",onClick:t,children:"\xd7"})]})]})}),(0,a.jsx)(I,{className:"p-0",children:(0,a.jsxs)("div",{className:"flex h-[600px]",children:[(0,a.jsx)("div",{className:(0,N.cn)("flex-1 p-6 overflow-y-auto",g&&"border-r"),children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(W,{htmlFor:"visibility",children:"Visibility:"}),(0,a.jsxs)(ej,{value:j,onValueChange:f,children:[(0,a.jsx)(eg,{className:"w-32",children:(0,a.jsx)(ef,{})}),(0,a.jsxs)(ev,{children:[(0,a.jsx)(eb,{value:"public",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(eE.A,{className:"h-4 w-4"}),"Public"]})}),(0,a.jsx)(eb,{value:"space",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(c.A,{className:"h-4 w-4"}),"Space"]})}),(0,a.jsx)(eb,{value:"private",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(eI.A,{className:"h-4 w-4"}),"Private"]})})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(W,{htmlFor:"schedule",children:"Schedule:"}),(0,a.jsx)(k,{id:"schedule",type:"datetime-local",value:b,onChange:e=>w(e.target.value),className:"w-40"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(W,{htmlFor:"content",children:"Content"}),(0,a.jsx)(ei,{id:"content",placeholder:"Share your thoughts with full transparency...",value:x,onChange:e=>u(e.target.value),className:"min-h-[200px] resize-none"}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:[x.length," characters • ",x.split(/\s+/).filter(e=>e.length>0).length," words"]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(W,{htmlFor:"tags",children:"Tags"}),(0,a.jsx)(k,{id:"tags",placeholder:"Add tags separated by commas...",className:"w-full",value:h,onChange:e=>p(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(W,{children:"Content Ranking Preferences"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(W,{className:"text-sm",children:"Coherence Weight"}),(0,a.jsxs)("span",{className:"text-sm font-medium",children:[S[0],"%"]})]}),(0,a.jsx)(ek,{value:S,onValueChange:D,max:100,step:5,className:"w-full"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(W,{className:"text-sm",children:"Engagement Weight"}),(0,a.jsxs)("span",{className:"text-sm font-medium",children:[L[0],"%"]})]}),(0,a.jsx)(ek,{value:L,onValueChange:z,max:100,step:5,className:"w-full"})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between pt-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(y,{variant:"outline",size:"sm",onClick:()=>{x.length;let e=x.split(/\s+/).filter(e=>e.length>0).length,s=e=>{let s=0;for(let t=0;t<e.length;t++)s=(s<<5)-s+e.charCodeAt(t),s&=s;return Math.abs(s)/0x7fffffff},t=x+h+j,a=s(t+"coh"),r=s(t+"rew"),n=s(t+"rea"),i=Math.min(.95,e/100*.8+.15*a),l=50*i+20*r,c=Math.floor(1e3*i+500*n);P({...T,coherenceScore:i,rewardPotential:l,estimatedReach:c,guardChecks:[{name:"Content Quality",status:i>.7?"pass":"warning",description:i>.7?"High quality content detected":"Content could be more detailed"},{name:"Space Guidelines",status:"pass",description:"Content aligns with space standards"},{name:"Economic Impact",status:l>30?"pass":"warning",description:l>30?"Positive economic impact expected":"Lower reward potential"},{name:"Spam Detection",status:"pass",description:"No spam patterns detected"}],projections:{immediateRewards:.3*l,longTermRewards:.7*l,reputationImpact:.1*i,networkEffect:.05*c}})},children:[(0,a.jsx)(eD.A,{className:"h-4 w-4 mr-1"}),"Analyze"]}),(0,a.jsxs)(y,{variant:"outline",size:"sm",children:[(0,a.jsx)(eF.A,{className:"h-4 w-4 mr-1"}),"Save Draft"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(y,{variant:"outline",onClick:t,children:"Cancel"}),(0,a.jsx)(y,{onClick:O,disabled:m||!x.trim(),children:m?"Publishing...":b?"Schedule":"Publish"})]})]})]})}),g&&(0,a.jsx)("div",{className:"w-96 p-6 overflow-y-auto bg-muted/30",children:(0,a.jsxs)(ec,{defaultValue:"overview",className:"w-full",children:[(0,a.jsxs)(ed,{className:"grid w-full grid-cols-3",children:[(0,a.jsx)(eo,{value:"overview",children:"Overview"}),(0,a.jsx)(eo,{value:"guards",children:"Guards"}),(0,a.jsx)(eo,{value:"projections",children:"Projections"})]}),(0,a.jsx)(em,{value:"overview",className:"space-y-4",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"text-center p-3 bg-background rounded-lg",children:[(0,a.jsx)(eL.A,{className:"h-6 w-6 mx-auto mb-1 text-green-600"}),(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600",children:T.coherenceScore.toFixed(2)}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"Coherence Score"})]}),(0,a.jsxs)("div",{className:"text-center p-3 bg-background rounded-lg",children:[(0,a.jsx)(o.A,{className:"h-6 w-6 mx-auto mb-1 text-blue-600"}),(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:T.rewardPotential.toFixed(1)}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"FLX Rewards"})]})]}),(0,a.jsxs)("div",{className:"p-3 bg-background rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:"Estimated Reach"}),(0,a.jsx)("span",{className:"text-sm font-bold",children:T.estimatedReach})]}),(0,a.jsx)(eA,{value:T.estimatedReach/2e3*100,className:"h-2"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{children:"Content Quality"}),(0,a.jsx)("span",{className:"font-medium",children:"High"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{children:"Network Effect"}),(0,a.jsx)("span",{className:"font-medium",children:"Positive"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{children:"Reward Distribution"}),(0,a.jsx)("span",{className:"font-medium",children:"Fair"})]})]})]})}),(0,a.jsx)(em,{value:"guards",className:"space-y-3",children:(0,a.jsx)("div",{className:"space-y-3",children:T.guardChecks.map((e,s)=>(0,a.jsx)("div",{className:"p-3 bg-background rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[K(e.status),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:e.name}),(0,a.jsx)(A,{variant:"pass"===e.status?"default":"warning"===e.status?"secondary":"destructive",className:"text-xs",children:e.status})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:e.description})]})]})},s))})}),(0,a.jsx)(em,{value:"projections",className:"space-y-4",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("div",{className:"p-3 bg-background rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-sm",children:"Immediate Rewards"}),(0,a.jsxs)("span",{className:"font-bold text-green-600",children:["+",T.projections.immediateRewards.toFixed(1)," FLX"]})]})}),(0,a.jsx)("div",{className:"p-3 bg-background rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-sm",children:"Long-term Rewards"}),(0,a.jsxs)("span",{className:"font-bold text-blue-600",children:["+",T.projections.longTermRewards.toFixed(1)," FLX"]})]})}),(0,a.jsx)("div",{className:"p-3 bg-background rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-sm",children:"Reputation Impact"}),(0,a.jsxs)("span",{className:"font-bold text-purple-600",children:["+",T.projections.reputationImpact.toFixed(3)]})]})}),(0,a.jsx)("div",{className:"p-3 bg-background rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-sm",children:"Network Effect"}),(0,a.jsxs)("span",{className:"font-bold text-orange-600",children:["+",T.projections.networkEffect.toFixed(0)," users"]})]})}),(0,a.jsxs)("div",{className:"mt-4 p-3 bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg border",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(ez.A,{className:"h-4 w-4 text-blue-600"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Total Potential"})]}),(0,a.jsxs)("div",{className:"text-2xl font-bold text-blue-600",children:[(T.projections.immediateRewards+T.projections.longTermRewards).toFixed(1)," FLX"]})]})]})})]})})]})})]})}):null}var eU=t(90437),eG=t(84616),eW=t(17580),eB=t(12486);let eJ="atlas_session_v1";async function eQ(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{auth:t=!0,headers:a={},...r}=s,n=new Headers(a);if(s.body&&!n.has("Content-Type")&&n.set("Content-Type","application/json"),t){let e=localStorage.getItem(eJ);if(e)try{let s=JSON.parse(e);s.session_token&&n.set("Authorization","Bearer ".concat(s.session_token))}catch(e){console.error("Failed to parse session for auth header",e)}}let i=e.startsWith("http")?e:"".concat("http://localhost:8000").concat(e),l=await fetch(i,{...r,headers:n});return 401===l.status&&t&&(localStorage.removeItem(eJ),window.dispatchEvent(new Event("atlas-auth-expired"))),l}function eX(){let{isConnected:e,address:s}=M(),{messages:t,sendMessage:n,isLoading:l}=function(){let{address:e,isConnected:s,sessionToken:t}=M(),[a,n]=(0,r.useState)([]),[i,l]=(0,r.useState)(!0),c=(0,r.useCallback)(async()=>{if(s&&t)try{let s=await fetch("http://localhost:8000/api/chat/messages?room_id=general",{headers:{Authorization:"Bearer ".concat(t)}});if(s.ok){let t=await s.json();n(t.messages.map(s=>({id:s.id,sender:s.author,text:s.content,timestamp:new Date(1e3*s.timestamp).toISOString(),isOwn:s.author===e,status:"read"})))}}catch(e){console.error("Failed to fetch chat history:",e)}finally{l(!1)}},[s,t,e]);return(0,r.useEffect)(()=>{c();let e=setInterval(c,1e4);return()=>clearInterval(e)},[c]),{messages:a,isLoading:i,sendMessage:async e=>{console.log("WebSocket chat not fully implemented in hook yet")},refresh:c}}(),[c,o]=(0,r.useState)("conv_1"),[m,x]=(0,r.useState)(""),[h,p]=(0,r.useState)(""),{data:j=[],isLoading:g}=(0,i.I)({queryKey:["conversations"],queryFn:async()=>{let e=await eQ("/api/v18/chat/conversations");if(!e.ok)throw Error("Failed to fetch conversations");return e.json()}}),v=j.find(e=>e.id===c),b=e=>{switch(e){case"sent":return(0,a.jsx)(eh.A,{className:"h-3 w-3 text-muted-foreground"});case"delivered":return(0,a.jsx)(eU.A,{className:"h-3 w-3 text-muted-foreground"});case"read":return(0,a.jsx)(eU.A,{className:"h-3 w-3 text-blue-500"});default:return null}},N=j.filter(e=>e.name.toLowerCase().includes(h.toLowerCase()));return(0,a.jsxs)("div",{className:"h-[600px] flex",children:[(0,a.jsxs)("div",{className:"w-80 border-r flex flex-col",children:[(0,a.jsxs)("div",{className:"p-4 border-b",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:"font-semibold",children:"Messages"}),(0,a.jsx)(y,{size:"sm",children:(0,a.jsx)(eG.A,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(f.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(k,{placeholder:"Search conversations...",className:"pl-10",value:h,onChange:e=>p(e.target.value)})]})]}),(0,a.jsx)(z,{className:"flex-1",children:(0,a.jsx)("div",{className:"p-2",children:N.map(e=>(0,a.jsx)("div",{className:"p-3 rounded-lg cursor-pointer transition-colors hover:bg-muted/50 ".concat(c===e.id?"bg-muted":""),onClick:()=>o(e.id),children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)(R,{className:"h-10 w-10",children:[(0,a.jsx)(q,{src:e.avatar}),(0,a.jsx)(O,{children:e.name.split(" ").map(e=>e[0]).join("")})]}),e.isGroup&&(0,a.jsx)("div",{className:"absolute -bottom-1 -right-1 bg-blue-500 rounded-full p-1",children:(0,a.jsx)(eW.A,{className:"h-3 w-3 text-white"})})]}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,a.jsx)("h4",{className:"font-medium truncate",children:e.name}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:e.timestamp})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[e.isEncrypted&&(0,a.jsx)(u.A,{className:"h-3 w-3 text-green-500"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground truncate",children:e.lastMessage})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-1",children:[e.isGroup&&(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:[e.members," members"]}),e.unread>0&&(0,a.jsx)(A,{variant:"default",className:"text-xs",children:e.unread})]})]})]})},e.id))})})]}),v?(0,a.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,a.jsx)("div",{className:"p-4 border-b bg-card",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)(R,{className:"h-8 w-8",children:[(0,a.jsx)(q,{src:v.avatar}),(0,a.jsx)(O,{children:v.name.split(" ").map(e=>e[0]).join("")})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium",children:v.name}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[v.isEncrypted&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.A,{className:"h-3 w-3 text-green-500"}),(0,a.jsx)("span",{children:"End-to-end encrypted"})]}),v.isGroup&&(0,a.jsxs)("span",{children:["• ",v.members," members"]})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(y,{variant:"ghost",size:"sm",children:(0,a.jsx)(e_.A,{className:"h-4 w-4"})}),(0,a.jsx)(y,{variant:"ghost",size:"sm",children:(0,a.jsx)(eW.A,{className:"h-4 w-4"})})]})]})}),(0,a.jsx)(z,{className:"flex-1 p-4",children:(0,a.jsx)("div",{className:"space-y-4",children:t.map(e=>(0,a.jsx)("div",{className:"flex ".concat(e.isOwn?"justify-end":"justify-start"),children:(0,a.jsxs)("div",{className:"max-w-[70%] ".concat(e.isOwn?"order-2":"order-1"),children:[!e.isOwn&&(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsx)(R,{className:"h-6 w-6",children:(0,a.jsx)(O,{className:"text-xs",children:e.sender.split(" ").map(e=>e[0]).join("")})}),(0,a.jsx)("span",{className:"text-xs font-medium",children:e.sender})]}),(0,a.jsxs)("div",{className:"p-3 rounded-lg ".concat(e.isOwn?"bg-primary text-primary-foreground ml-auto":"bg-muted"),children:[(0,a.jsx)("p",{className:"text-sm",children:e.text}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1 text-xs ".concat(e.isOwn?"text-primary-foreground/70":"text-muted-foreground"),children:[(0,a.jsx)("span",{children:e.timestamp}),e.ledgerId&&(0,a.jsxs)(A,{variant:"secondary",className:"text-xs",children:["Ledger: ",e.ledgerId]}),e.isOwn&&b(e.status)]})]})]})},e.id))})}),(0,a.jsxs)("div",{className:"p-4 border-t bg-card",children:[(0,a.jsxs)("div",{className:"flex items-end gap-2",children:[(0,a.jsx)(ei,{placeholder:"Type a message... (All messages are logged to the ledger)",value:m,onChange:e=>x(e.target.value),className:"min-h-[40px] max-h-32 resize-none",onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),n(m),x(""))}}),(0,a.jsx)(y,{size:"icon",onClick:()=>{n(m),x("")},children:(0,a.jsx)(eB.A,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2 text-xs text-muted-foreground",children:[(0,a.jsx)(u.A,{className:"h-3 w-3 text-green-500"}),(0,a.jsx)("span",{children:"All messages are end-to-end encrypted and logged to the QFS ledger for transparency"})]})]})]}):(0,a.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(d.A,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),(0,a.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Select a conversation"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Choose a conversation from the list to start messaging with full transparency"})]})})]})}class eH{static getInstance(){return eH.instance||(eH.instance=new eH),eH.instance}init(){}add(e){this.events.set(e.id,e)}get(e){return this.events.get(e)}getAll(){return Array.from(this.events.values())}remove(e){this.events.delete(e)}clear(){this.events.clear()}constructor(){this.events=new Map}}function eY(){return eH.getInstance()}var eZ=t(50757);function e$(){let{events:e,isLoading:s,error:t}=function(){let[e,s]=(0,r.useState)([]),[t,a]=(0,r.useState)(!0),[n,i]=(0,r.useState)(null),l=(0,r.useCallback)(async()=>{a(!0);try{let e=await eY(),t=(await e.getAll()).sort((e,s)=>s.timestamp-e.timestamp);s(t),i(null)}catch(e){console.error("Failed to fetch feed:",e),i(e)}finally{a(!1)}},[]);return(0,r.useEffect)(()=>{l();let e=setInterval(l,3e3);return()=>clearInterval(e)},[l]),{events:e,isLoading:t,error:n,refresh:l}}();return s&&0===e.length?(0,a.jsx)("div",{className:"p-4 text-center text-muted-foreground",children:"Loading feed..."}):t?(0,a.jsxs)("div",{className:"p-4 text-center text-red-500",children:["Error loading feed: ",t.message]}):(0,a.jsxs)(C,{className:"w-full h-full border-none shadow-none",children:[(0,a.jsxs)(F,{children:[(0,a.jsx)(_,{children:"Activity Feed"}),(0,a.jsx)(E,{children:"Real-time events pending ledger confirmation"})]}),(0,a.jsx)(I,{children:(0,a.jsx)(z,{className:"h-[600px] pr-4",children:(0,a.jsx)("div",{className:"space-y-4",children:0===e.length?(0,a.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No activity yet. Create some content!"}):e.map(e=>{var s;return(0,a.jsx)(C,{className:"overflow-hidden",children:(0,a.jsxs)("div",{className:"p-4 space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(A,{variant:"outline",className:"font-mono text-xs",children:e.eventType}),(0,a.jsxs)("div",{className:"flex items-center text-xs text-muted-foreground",children:[(0,a.jsx)(eF.A,{className:"w-3 h-3 mr-1"}),(0,eZ.m)(e.timestamp,{addSuffix:!0})]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("p",{className:"text-sm font-medium",children:["Event ID: ",(0,a.jsxs)("span",{className:"font-mono text-xs text-muted-foreground",children:[e.id.slice(0,8),"..."]})]}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground break-all",children:["ContentCreated"===e.eventType&&(0,a.jsxs)("span",{children:["Created content CID: ",(0,a.jsxs)("span",{className:"font-mono text-xs bg-muted px-1 rounded",children:[null==(s=e.eventData.contentCID)?void 0:s.slice(0,16),"..."]})]}),"ProfileUpdated"===e.eventType&&(0,a.jsx)("span",{children:"Updated profile"})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between pt-2 border-t",children:[(0,a.jsxs)("div",{className:"flex items-center text-xs",children:["Status:",(0,a.jsx)(A,{variant:"confirmed"===e.status?"default":"secondary",className:"ml-2 capitalize",children:e.status})]}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground font-mono",children:[e.did.slice(0,12),"..."]})]})]})},e.id)})})})})]})}let e0=[{nodeDID:"did:key:qfs_primary_01"},{nodeDID:"did:key:qfs_primary_02"},{nodeDID:"did:key:qfs_replica_01"}];var e1=t(25487),e2=t(43453);function e4(){let{isConnected:e}=M(),{feed:s,loading:t,nodes:n,selectedNode:i,selectNode:l}=function(){let{isConnected:e,address:s}=M(),[t,a]=(0,r.useState)([]),[n,i]=(0,r.useState)(!0),[l,c]=(0,r.useState)(e0[0]);(0,r.useEffect)(()=>{if(!e||!s){i(!1),a([]);return}d()},[l,e,s]);let d=async()=>{if(!e||!s)return void i(!1);i(!0);try{let e=await eQ("/api/v18/content/feed?limit=20");if(!e.ok)throw Error("HTTP error! status: ".concat(e.status," "));let s=(await e.json()).map(e=>({id:e.id,cid:e.content_hash,authorDID:e.sender,content:{text:e.content},coherenceScore:1,proof:"ledger_".concat(e.content_hash.slice(0,8)," "),timestamp:1e3*e.timestamp}));a(s)}catch(e){console.error("Failed to fetch QFS feed:",e)}finally{i(!1)}};return{feed:t,loading:n,refresh:d,nodes:e0,selectedNode:l,selectNode:c}}();return e?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(C,{className:"bg-muted/30",children:(0,a.jsxs)(F,{className:"pb-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(e1.A,{className:"h-5 w-5 text-primary"}),(0,a.jsx)(_,{className:"text-lg",children:"QFS Node Network"})]}),(0,a.jsxs)(ej,{value:i.nodeDID,onValueChange:e=>{let s=n.find(s=>s.nodeDID===e);s&&l(s)},children:[(0,a.jsx)(eg,{className:"w-[280px]",children:(0,a.jsx)(ef,{placeholder:"Select a trusted node"})}),(0,a.jsx)(ev,{children:n.map(e=>(0,a.jsx)(eb,{value:e.nodeDID,children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(u.A,{className:"h-3 w-3 text-green-500"}),(0,a.jsxs)("span",{className:"font-mono",children:[e.nodeDID.slice(0,16),"..."]})]})},e.nodeDID))})]})]}),(0,a.jsxs)(E,{children:["You are viewing the content reality computed by ",(0,a.jsxs)("strong",{children:[i.nodeDID.slice(0,12),"..."]}),". Verifiable by Merkle Proofs."]})]})}),(0,a.jsx)("div",{className:"space-y-4",children:t?(0,a.jsx)("div",{className:"text-center py-10",children:"Connecting to distributed node..."}):s.map(e=>(0,a.jsx)(C,{children:(0,a.jsxs)(I,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(R,{children:(0,a.jsx)(O,{children:e.authorDID.slice(8,10).toUpperCase()})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:e.authorDID}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:new Date(e.timestamp).toLocaleTimeString()})]})]}),(0,a.jsxs)("div",{className:"flex flex-col items-end gap-1",children:[(0,a.jsxs)(A,{variant:"outline",className:"text-green-600 border-green-200 bg-green-50",children:["Coherence: ",e.coherenceScore.toFixed(3)]}),(0,a.jsxs)("div",{className:"text-[10px] text-muted-foreground flex items-center gap-1",children:[(0,a.jsx)(e2.A,{className:"h-3 w-3"}),"Verified Proof"]})]})]}),(0,a.jsx)("p",{className:"text-base mb-4",children:e.content.text}),(0,a.jsxs)("div",{className:"p-2 bg-muted/50 rounded text-xs font-mono text-muted-foreground break-all",children:["Proof Root: ",e.proof]})]})},e.id))})]}):(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)(C,{className:"border-blue-500/30 bg-blue-500/5",children:[(0,a.jsxs)(F,{children:[(0,a.jsxs)(_,{className:"flex items-center gap-2",children:[(0,a.jsx)(eI.A,{className:"h-5 w-5 text-blue-600"}),"Public Feed Mode"]}),(0,a.jsx)(E,{children:"Connect your wallet to see your personalized distributed feed from trusted QFS nodes."})]}),(0,a.jsx)(I,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"p-4 bg-background/50 rounded-xl border border-blue-500/20",children:(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"The distributed feed shows content verified across multiple QFS nodes. Authentication is required to participate and view node-specific content."})}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,a.jsx)(u.A,{className:"h-4 w-4 text-green-500"}),(0,a.jsx)("span",{children:"All content is cryptographically verified"})]})]})})]})})}var e5=t(15448);let e3="http://localhost:8000";function e6(){let[e,s]=(0,r.useState)(!1),[t,a]=(0,r.useState)(null),[n,i]=(0,r.useState)(null);return{isLoading:e,error:t,explanation:n,fetchRewardExplanation:async(e,t)=>{s(!0),a(null);try{let s="".concat(e3,"/explain/reward/").concat(e).concat(t?"?epoch=".concat(t):""),a=await fetch(s,{headers:{Authorization:"Bearer ".concat(getAuthToken()),"Content-Type":"application/json"}});if(!a.ok){if(401===a.status)throw Error("Authentication required");if(403===a.status)throw Error("Permission denied");throw Error("Failed to fetch explanation")}let r=await a.json();i(r)}catch(e){console.error(e),a(e instanceof Error?e.message:"Could not load explanation."),i(null)}finally{s(!1)}},fetchRankingExplanation:async e=>{s(!0),a(null);try{let s="".concat(e3,"/explain/ranking/").concat(e),t=await fetch(s,{headers:{Authorization:"Bearer ".concat(getAuthToken()),"Content-Type":"application/json"}});if(!t.ok)throw Error("Failed to fetch explanation");let a=await t.json();i(a)}catch(e){console.error(e),a("Could not load explanation.")}finally{s(!1)}},clearExplanation:()=>{i(null),a(null)}}}var e8=t(45821);function e9(e){let{...s}=e;return(0,a.jsx)(e8.bL,{"data-slot":"dialog",...s})}function e7(e){let{...s}=e;return(0,a.jsx)(e8.l9,{"data-slot":"dialog-trigger",...s})}function se(e){let{...s}=e;return(0,a.jsx)(e8.ZL,{"data-slot":"dialog-portal",...s})}function ss(e){let{className:s,...t}=e;return(0,a.jsx)(e8.hJ,{"data-slot":"dialog-overlay",className:(0,N.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",s),...t})}function st(e){let{className:s,children:t,showCloseButton:r=!0,...n}=e;return(0,a.jsxs)(se,{"data-slot":"dialog-portal",children:[(0,a.jsx)(ss,{}),(0,a.jsxs)(e8.UC,{"data-slot":"dialog-content",className:(0,N.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",s),...n,children:[t,r&&(0,a.jsxs)(e8.bm,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,a.jsx)(p.A,{}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function sa(){let[e,s]=(0,r.useState)(""),[t,n]=(0,r.useState)("spaces"),{explanation:l,fetchRankingExplanation:o,isLoading:x,clearExplanation:h}=e6(),{data:p,isLoading:j}=(0,i.I)({queryKey:["spaces"],queryFn:async()=>{let e=await eQ("/api/v18/spaces");if(!e.ok)throw Error("Failed to fetch spaces");return e.json()}}),{data:f,isLoading:g}=(0,i.I)({queryKey:["trending"],queryFn:async()=>{let e=await eQ("/api/v18/trending");if(!e.ok)throw Error("Failed to fetch trending topics");return e.json()}}),{data:v,isLoading:b}=(0,i.I)({queryKey:["recommendations"],queryFn:async()=>{let e=await eQ("/api/v18/recommendations");if(!e.ok)throw Error("Failed to fetch recommendations");return e.json()}}),{data:N,isLoading:w}=(0,i.I)({queryKey:["activity"],queryFn:async()=>{let e=await eQ("/api/v18/activity");if(!e.ok)throw Error("Failed to fetch activity");return e.json()}}),S=(p||[]).filter(s=>s.name.toLowerCase().includes(e.toLowerCase())||s.description.toLowerCase().includes(e.toLowerCase())||s.tags.some(s=>s.toLowerCase().includes(e.toLowerCase()))),D=async e=>{try{if(!(await eQ("/api/v18/spaces/".concat(e,"/join"),{method:"POST"})).ok)throw Error("Failed to join space");alert("Successfully joined space ".concat(e,"!"))}catch(e){console.error("Error joining space:",e),alert("Failed to join space.")}};return(0,a.jsx)("div",{className:"max-w-6xl mx-auto space-y-6",children:(0,a.jsxs)(ec,{value:t,onValueChange:n,className:"w-full",children:[(0,a.jsxs)(ed,{className:"grid w-full grid-cols-4",children:[(0,a.jsx)(eo,{value:"spaces",children:"Spaces"}),(0,a.jsx)(eo,{value:"trending",children:"Trending Topics"}),(0,a.jsx)(eo,{value:"network",children:"Network & Trust"}),(0,a.jsx)(eo,{value:"discover",children:"Discover"}),(0,a.jsx)(eo,{value:"activity",children:"Raw Ledger"})]}),(0,a.jsxs)(em,{value:"spaces",className:"space-y-6",children:[(0,a.jsxs)(C,{children:[(0,a.jsx)(F,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(_,{children:"Spaces"}),(0,a.jsx)(E,{children:"Join spaces that align with your interests and values"})]}),(0,a.jsxs)(y,{children:[(0,a.jsx)(c.A,{className:"h-4 w-4 mr-2"}),"Create Space"]})]})}),(0,a.jsx)(I,{children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(e5.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(k,{placeholder:"Search spaces by name, description, or tags...",className:"pl-10",value:e,onChange:e=>s(e.target.value)})]})})]}),j?(0,a.jsx)("div",{className:"flex justify-center p-12",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:S.map(e=>(0,a.jsxs)(C,{className:"hover:shadow-md transition-shadow",children:[(0,a.jsx)(F,{children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)(R,{className:"h-12 w-12",children:[(0,a.jsx)(q,{src:e.avatar}),(0,a.jsx)(O,{children:e.name.split(" ").map(e=>e[0]).join("")})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h3",{className:"font-semibold",children:e.name}),e.isVerified&&(0,a.jsx)(u.A,{className:"h-4 w-4 text-blue-500"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,a.jsx)(eW.A,{className:"h-3 w-3"}),(0,a.jsxs)("span",{children:[(e.members||0).toLocaleString()," members"]}),e.isPublic?(0,a.jsx)(eE.A,{className:"h-3 w-3"}):(0,a.jsx)(u.A,{className:"h-3 w-3"})]})]})]}),(0,a.jsxs)(A,{variant:"outline",className:"text-green-600",children:["+",e.growthRate||0,"%"]})]})}),(0,a.jsxs)(I,{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:e.description}),(0,a.jsx)("div",{className:"flex flex-wrap gap-1 mb-4",children:(e.tags||[]).map(e=>(0,a.jsxs)(A,{variant:"secondary",className:"text-xs",children:["#",e]},e))}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,a.jsxs)("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center gap-1 mb-1",children:[(0,a.jsx)(eL.A,{className:"h-4 w-4 text-green-600"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Coherence"})]}),(0,a.jsx)("div",{className:"text-lg font-bold text-green-600",children:(e.coherence_rank||e.coherenceScore||0).toFixed(2)})]}),(0,a.jsxs)("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center gap-1 mb-1",children:[(0,a.jsx)(ez.A,{className:"h-4 w-4 text-blue-600"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Reward Pool"})]}),(0,a.jsxs)("div",{className:"text-lg font-bold text-blue-600",children:[(e.rewardPool||0).toFixed(0)," FLX"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(y,{className:"flex-1",onClick:()=>D(e.id),children:"Join Space"}),(0,a.jsx)(y,{variant:"outline",size:"sm",children:(0,a.jsx)(e_.A,{className:"h-4 w-4"})})]})]})]},e.id))})]}),(0,a.jsx)(em,{value:"trending",className:"space-y-6",children:(0,a.jsxs)(C,{children:[(0,a.jsxs)(F,{children:[(0,a.jsx)(_,{children:"Trending Topics"}),(0,a.jsx)(E,{children:"Discover what's trending across the ATLAS network with full transparency"})]}),(0,a.jsx)(I,{children:g?(0,a.jsx)("div",{className:"flex justify-center p-12",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):(0,a.jsx)("div",{className:"space-y-4",children:(f||[]).map((e,s)=>(0,a.jsxs)(e9,{onOpenChange:s=>{s?o(e.id):h()},children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/50 transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"text-2xl font-bold text-muted-foreground w-8",children:["#",s+1]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold mb-1",children:e.name}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(d.A,{className:"h-3 w-3"}),(0,a.jsxs)("span",{children:[e.posts.toLocaleString()," posts"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(m.A,{className:"h-3 w-3"}),(0,a.jsxs)("span",{children:[e.engagement.toLocaleString()," engagements"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(eL.A,{className:"h-3 w-3 text-green-600"}),(0,a.jsxs)("span",{className:"text-green-600",children:["+",e.growth,"%"]})]})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"text-sm font-medium",children:"Coherence"}),(0,a.jsx)("div",{className:"text-lg font-bold text-green-600",children:e.coherenceScore.toFixed(2)})]}),(0,a.jsx)(e7,{asChild:!0,children:(0,a.jsxs)(y,{variant:"outline",size:"sm",className:"gap-2",children:[(0,a.jsx)(e5.A,{className:"h-3 w-3"}),"Why?"]})}),(0,a.jsx)(y,{variant:"outline",children:"Explore"})]})]}),(0,a.jsx)(st,{className:"max-w-2xl",children:(0,a.jsx)($,{type:"ranking",explanation:l||void 0,isLoading:x})})]},e.id))})})]})}),(0,a.jsx)(em,{value:"network",className:"space-y-6",children:(0,a.jsx)(e4,{})}),(0,a.jsx)(em,{value:"discover",className:"space-y-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)(C,{children:[(0,a.jsxs)(F,{children:[(0,a.jsx)(_,{children:"Recommended for You"}),(0,a.jsx)(E,{children:"Spaces and topics based on your activity and interests"})]}),(0,a.jsx)(I,{children:(0,a.jsx)("div",{className:"space-y-4",children:(v||[]).map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsx)("h4",{className:"font-medium",children:e.name}),(0,a.jsx)(A,{variant:"outline",className:"text-xs",children:e.type})]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:e.reason})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"text-sm font-medium text-green-600",children:[e.match,"%"]}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"match"})]})]},s))})})]}),(0,a.jsxs)(C,{children:[(0,a.jsxs)(F,{children:[(0,a.jsx)(_,{children:"Network Activity"}),(0,a.jsx)(E,{children:"Real-time activity across the ATLAS network"})]}),(0,a.jsx)(I,{children:(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsx)("div",{className:"space-y-4",children:(N||[]).map((e,s)=>(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-2"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm",children:e.action}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,a.jsx)("span",{children:e.user}),(0,a.jsx)("span",{children:"•"}),(0,a.jsx)("span",{children:e.time})]})]})]},s))})})})]})]})}),(0,a.jsx)(em,{value:"activity",className:"space-y-6",children:(0,a.jsx)(e$,{})})]})})}function sr(){var e,s,t,r;let{balance:n,history:i,isLoading:l}=U(),{did:c}=eK(),{isConnected:m,address:x}=M(),{explanation:h,fetchRewardExplanation:p,isLoading:j,clearExplanation:f}=e6();if(!m)return(0,a.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,a.jsxs)(C,{className:"border-blue-500/30 bg-blue-500/5",children:[(0,a.jsxs)(F,{children:[(0,a.jsxs)(_,{className:"flex items-center gap-2",children:[(0,a.jsx)(u.A,{className:"h-5 w-5 text-blue-600"}),"Wallet Connection Required"]}),(0,a.jsx)(E,{children:"Connect your wallet to view your balance, transaction history, and internal credits."})]}),(0,a.jsxs)(I,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4 p-4 bg-background/50 rounded-xl border border-blue-500/20",children:[(0,a.jsx)(o.A,{className:"h-8 w-8 text-blue-600"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm font-semibold",children:"Secure Wallet Authentication"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Your wallet is used for cryptographic identity only. No transfers are supported."})]})]}),(0,a.jsx)("div",{className:"flex justify-center pt-4",children:(0,a.jsx)(er,{})})]})]})});let g=(null==n?void 0:n.balance.toFixed(2))||"0.00",v=(null==n?void 0:n.rewards.toFixed(2))||"0.00",b=(null==n?void 0:n.staked.toFixed(2))||"0.00";return(0,a.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,a.jsxs)(C,{children:[(0,a.jsxs)(F,{children:[(0,a.jsx)(_,{children:"Wallet Balance"}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)(E,{children:m?(0,a.jsxs)("span",{className:"text-blue-600 font-mono",children:["Connected: ",null==x?void 0:x.slice(0,6),"...",null==x?void 0:x.slice(-4)]}):(0,a.jsxs)("span",{children:["DID: ",c?"".concat(c.slice(0,20),"..."):"Not connected"]})}),(0,a.jsx)(er,{})]})]}),(0,a.jsx)(I,{children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"p-4 bg-blue-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(o.A,{className:"h-5 w-5 text-blue-600"}),(0,a.jsx)("span",{className:"font-medium text-blue-900",children:"Wallet Balance"})]}),(0,a.jsxs)("div",{className:"text-2xl font-bold text-blue-600",children:[g," FLX"]}),(0,a.jsxs)("div",{className:"text-sm text-blue-700 font-medium",children:["Staked: ",b]})]}),(0,a.jsxs)("div",{className:"p-4 bg-green-50 rounded-lg border border-green-100",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(ez.A,{className:"h-5 w-5 text-green-600"}),(0,a.jsx)("span",{className:"font-medium text-green-900",children:"Accrued Rewards"})]}),(0,a.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:[v," FLX"]}),(0,a.jsx)("div",{className:"text-sm text-green-700 font-medium",children:"V18 Yield Pool"})]}),(0,a.jsxs)("div",{className:"p-4 bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(eL.A,{className:"h-5 w-5 text-purple-600"}),(0,a.jsx)("span",{className:"font-medium text-purple-900",children:"Reputation"})]}),(0,a.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:(null==n||null==(e=n.reputation)?void 0:e.toFixed(0))||"0"}),(0,a.jsx)("div",{className:"text-sm text-purple-700 font-medium",children:"Network weight"})]})]})})]}),(0,a.jsxs)(C,{children:[(0,a.jsx)(F,{children:(0,a.jsx)(_,{children:"Reward History"})}),(0,a.jsx)(I,{children:(0,a.jsx)("div",{className:"space-y-3",children:0===i.length?(0,a.jsx)("div",{className:"text-center text-muted-foreground py-4",children:"No recent transactions"}):i.map(e=>(0,a.jsxs)(e9,{onOpenChange:e=>{e?p(x||c||"wallet_123",10):f()},children:[(0,a.jsx)(e7,{asChild:!0,children:(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-muted/30 rounded-lg cursor-pointer hover:bg-muted/50 transition-colors",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:e.reason}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:[new Date(e.timestamp).toLocaleTimeString()," • ",e.id.split("_")[2],(0,a.jsx)(A,{variant:"outline",className:"ml-2 text-[10px] h-5",children:"Explain"})]})]}),(0,a.jsxs)("div",{className:e.amount>=0?"text-green-600 font-bold":"text-red-600 font-bold",children:[e.amount>=0?"+":"",e.amount.toFixed(2)," FLX"]})]})}),(0,a.jsx)(st,{className:"max-w-2xl",children:(0,a.jsx)($,{type:"reward",explanation:h||void 0,isLoading:j})})]},e.id))})})]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(C,{children:[(0,a.jsx)(F,{children:(0,a.jsx)(_,{children:"Reputation Breakdown"})}),(0,a.jsx)(I,{children:(0,a.jsx)("div",{className:"space-y-4",children:[{label:"Content Quality",val:(null==n||null==(s=n.reputation_breakdown)?void 0:s.content_quality)||0,color:"bg-green-600"},{label:"Engagement",val:(null==n||null==(t=n.reputation_breakdown)?void 0:t.engagement)||0,color:"bg-blue-600"},{label:"Governance",val:(null==n||null==(r=n.reputation_breakdown)?void 0:r.governance)||0,color:"bg-purple-600"}].map(e=>(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,a.jsx)("span",{className:"text-sm",children:e.label}),(0,a.jsxs)("span",{className:"text-sm font-medium",children:[(100*e.val).toFixed(0),"%"]})]}),(0,a.jsx)("div",{className:"w-full bg-muted rounded-full h-2",children:(0,a.jsx)("div",{className:"".concat(e.color," h-2 rounded-full transition-all duration-500"),style:{width:"".concat(100*e.val,"%")}})})]},e.label))})})]}),(0,a.jsxs)(C,{children:[(0,a.jsxs)(F,{children:[(0,a.jsx)(_,{children:"Action Simulator"}),(0,a.jsx)(E,{children:"Simulate potential rewards"})]}),(0,a.jsx)(I,{children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)(y,{variant:"outline",className:"w-full justify-start",disabled:!0,children:[(0,a.jsx)(d.A,{className:"h-4 w-4 mr-2"}),"Post Content (Use 'Create' Tab)"]}),(0,a.jsxs)(y,{variant:"outline",className:"w-full justify-start",children:[(0,a.jsx)(eW.A,{className:"h-4 w-4 mr-2"}),"Join Space"]})]})})]})]})]})})}var sn=t(18186),si=t(69074),sl=t(65453);let sc="atlas_session_v1",sd=e=>{if(e.isConnected&&e.sessionToken&&e.address){let s={session_token:e.sessionToken,wallet_address:e.address,expires_at:new Date(Date.now()+864e5).toISOString()};localStorage.setItem(sc,JSON.stringify(s)),console.log("[Auth Store] Session persisted",s)}else localStorage.removeItem(sc),console.log("[Auth Store] Session cleared")},so=(0,sl.v)((e,s)=>({isConnected:!1,address:null,sessionToken:null,isLoading:!1,error:null,setState:s=>e(e=>{let t={...e,...s};return sd(t),t}),logout:()=>{localStorage.removeItem(sc),e({isConnected:!1,address:null,sessionToken:null,isLoading:!1,error:null}),console.log("[Auth Store] Logged out")}}));{window.addEventListener("atlas-auth-expired",()=>{console.warn("[Auth Store] Global auth expiration event received. Logging out."),so.getState().logout()});let e=localStorage.getItem(sc);if(e)try{let s=JSON.parse(e),t=new Date(s.expires_at).getTime()/1e3,a=Date.now()/1e3;t>a?(so.getState().setState({isConnected:!0,address:s.wallet_address,sessionToken:s.session_token}),console.log("[Auth Store] Session restored from localStorage")):(localStorage.removeItem(sc),console.log("[Auth Store] Stored session expired, cleared"))}catch(e){console.error("[Auth Store] Failed to parse stored session:",e),localStorage.removeItem(sc)}}var sm=t(16380);function sx(){let{triggerAuth:e,isConnected:s,isLoading:t}=M(),{address:n}=so(),[i,l]=(0,r.useState)(null),[c,d]=(0,r.useState)(!1),{session:o,connect:m}=(0,sm.G)(),x=!!(null==o?void 0:o.address),{openConnectModal:u}=(0,ea.Vx)(),h=async()=>{if(n){d(!0);try{let e=await fetch("/api/v18/rewards/streak?wallet=".concat(n));if(e.ok){let s=await e.json();l(s)}}catch(e){console.error("Failed to fetch streak",e)}finally{d(!1)}}};(0,r.useEffect)(()=>{s&&n&&h()},[s,n]);let p=async()=>{await e(),await h()},j=(null==i?void 0:i.day_index)||0;return(0,a.jsxs)(C,{className:"border-amber-200 bg-amber-50/50 dark:bg-amber-950/20",children:[(0,a.jsxs)(F,{className:"pb-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(_,{className:"text-lg flex items-center gap-2 text-amber-800 dark:text-amber-400",children:[(0,a.jsx)(sn.A,{className:"h-5 w-5"}),"Daily Presence"]}),(0,a.jsxs)("span",{className:"text-sm font-bold text-amber-600",children:["Day ",j,"/15"]})]}),(0,a.jsx)(E,{children:"Sign daily to boost coherence & reputation."})]}),(0,a.jsx)(I,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(eA,{value:j/15*100,className:"h-2 bg-amber-200"}),(0,a.jsxs)("div",{className:"flex justify-between text-xs text-muted-foreground",children:[(0,a.jsxs)("span",{children:["Current Reward: ",(null==i?void 0:i.current_reward)||0," FLX"]}),(0,a.jsx)("span",{children:"Target: 15 Days"})]}),(0,a.jsx)(y,{onClick:x?s?p:e:()=>{u?u():(console.warn("RainbowKit modal not available"),m("metamask"))},disabled:t,className:"w-full bg-gradient-to-r from-amber-500 to-orange-500 hover:from-amber-600 hover:to-orange-600 text-white",children:t?"Processing...":s?(0,a.jsxs)("span",{className:"flex items-center gap-2",children:[(0,a.jsx)(e2.A,{className:"h-4 w-4"}),"Sign Today's Presence"]}):x?(0,a.jsxs)("span",{className:"flex items-center gap-2",children:[(0,a.jsx)(e2.A,{className:"h-4 w-4"}),"Verify Presence (Sign)"]}):(0,a.jsxs)("span",{className:"flex items-center gap-2",children:[(0,a.jsx)(si.A,{className:"h-4 w-4"}),"Connect to Start Streak"]})})]})})]})}async function su(e){return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",e))).map(e=>e.toString(16).padStart(2,"0")).join("")}async function sh(e){let s=function e(s){if("object"!=typeof s||null===s)return JSON.stringify(s);if(Array.isArray(s))return"[".concat(s.map(e).join(","),"]");let t=Object.keys(s).sort().filter(e=>void 0!==s[e]).map(t=>'"'.concat(t,'":').concat(e(s[t])));return"{".concat(t.join(","),"}")}(e);return su(new TextEncoder().encode(s))}function sp(){let{did:e}=eK(),{updateProfile:s,isUpdating:t}=function(){let{did:e}=eK(),[s,t]=(0,r.useState)(!1);return{updateProfile:async s=>{if(!e)return void console.error("No identity found");t(!0);try{let t=await sh(s),a=crypto.randomUUID(),r={eventType:"ProfileUpdated",pendingId:a,actorDID:e,inputs:s,eventInputHash:t,createdAtMs:Date.now(),status:"pending"},n=await eY();return await n.save(r),console.log("[Profile] Submitted update for ".concat(e)),a}catch(e){throw console.error("Failed to update profile:",e),e}finally{t(!1)}},isUpdating:s}}(),[n,i]=(0,r.useState)(""),[l,c]=(0,r.useState)(""),[d,o]=(0,r.useState)(""),m=async t=>{t.preventDefault(),e&&(await s({name:n||void 0,bio:l||void 0,avatar:d||void 0}),alert("Profile update submitted to ledger!"))};return(0,a.jsxs)(C,{children:[(0,a.jsxs)(F,{children:[(0,a.jsx)(_,{children:"Edit Profile"}),(0,a.jsxs)(E,{children:["Updates are recorded on the public ledger for transparency. DID: ",e?"".concat(e.slice(0,16),"..."):"Not connected"]})]}),(0,a.jsx)(I,{children:(0,a.jsxs)("form",{onSubmit:m,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(W,{htmlFor:"name",children:"Display Name"}),(0,a.jsx)(k,{id:"name",placeholder:"Enter your public name",value:n,onChange:e=>i(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(W,{htmlFor:"bio",children:"Bio"}),(0,a.jsx)(ei,{id:"bio",placeholder:"Tell the network about yourself",value:l,onChange:e=>c(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(W,{htmlFor:"avatar",children:"Avatar CID / URL"}),(0,a.jsx)(k,{id:"avatar",placeholder:"ipfs://... or https://...",value:d,onChange:e=>o(e.target.value)})]}),(0,a.jsx)(y,{type:"submit",disabled:t,children:t?"Submitting...":"Update Profile"})]})})]})}class sj{static getInstance(){return sj.instance||(sj.instance=new sj),sj.instance}async getProposals(e){try{let s=await eQ("/api/v18/governance/proposals".concat(e?"?status=".concat(e):""));if(!s.ok)throw Error("HTTP error! status: ".concat(s.status));return(await s.json()).map(e=>({id:e.id,title:e.title,description:e.description,creator:e.creator,createdAt:e.created_at?1e3*e.created_at:Date.now(),status:e.status,votesFor:e.votes_for||0,votesAgainst:e.votes_against||0}))}catch(e){return console.error("Failed to fetch proposals:",e),[]}}async getProposal(e){try{return(await this.getProposals()).find(s=>s.id===e)||null}catch(e){return console.error("Failed to fetch proposal:",e),null}}async createProposal(e,s,t){return""}async vote(e,s,t){let a=await eQ("/api/v18/governance/vote",{method:"POST",body:JSON.stringify({proposalId:e,voter:s,choice:t})});if(!a.ok)throw Error("Failed to vote: ".concat(a.statusText));let r=await a.json();if("voted"!==r.status)throw Error(r.message||"Vote failed")}constructor(){}}var sf=t(57434),sg=t(54861);function sv(){let{did:e}=eK(),[s,t]=(0,r.useState)([]),[n,i]=(0,r.useState)(!0),l=sj.getInstance();(0,r.useEffect)(()=>{c()},[]);let c=async()=>{i(!0);try{let e=await l.getProposals();t(e)}catch(e){console.error(e)}finally{i(!1)}},d=async(s,t)=>{if(e)try{await l.vote(s,e,t),await c()}catch(e){console.error("Voting failed:",e),alert("Failed to cast vote. Please try again.")}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold tracking-tight",children:"Protocol Governance"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Vote on parameter updates and policy changes."})]}),(0,a.jsxs)(y,{children:[(0,a.jsx)(sf.A,{className:"mr-2 h-4 w-4"}),"New Proposal"]})]}),(0,a.jsxs)(ec,{defaultValue:"active",className:"w-full",children:[(0,a.jsxs)(ed,{children:[(0,a.jsx)(eo,{value:"active",children:"Active"}),(0,a.jsx)(eo,{value:"passed",children:"Passed"}),(0,a.jsx)(eo,{value:"rejected",children:"Rejected"})]}),(0,a.jsx)(em,{value:"active",className:"space-y-4 mt-4",children:n?(0,a.jsx)("div",{children:"Loading proposals..."}):0===s.filter(e=>"active"===e.status).length?(0,a.jsx)("div",{className:"text-center py-10 text-muted-foreground",children:"No active proposals"}):s.filter(e=>"active"===e.status).map(s=>(0,a.jsx)(sb,{proposal:s,onVote:d,did:e},s.id))}),(0,a.jsx)(em,{value:"passed",className:"mt-4 space-y-4",children:s.filter(e=>"passed"===e.status||"executed"===e.status).map(s=>(0,a.jsx)(sb,{proposal:s,onVote:d,did:e,readonly:!0},s.id))}),(0,a.jsx)(em,{value:"rejected",className:"mt-4 space-y-4",children:s.filter(e=>"rejected"===e.status).map(s=>(0,a.jsx)(sb,{proposal:s,onVote:d,did:e,readonly:!0},s.id))})]})]})}function sb(e){let{proposal:s,onVote:t,did:r,readonly:n=!1}=e,i=s.votesFor+s.votesAgainst,l=i>0?s.votesFor/i*100:0;return(0,a.jsxs)(C,{children:[(0,a.jsx)(F,{children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(_,{className:"text-lg",children:s.title}),(0,a.jsxs)(E,{className:"mt-1",children:["ID: ",s.id.slice(0,12),"... • Creator: ",s.creator.slice(0,16),"..."]})]}),(0,a.jsx)(A,{variant:"active"===s.status?"default":"secondary",children:s.status.toUpperCase()})]})}),(0,a.jsxs)(I,{className:"space-y-4",children:[(0,a.jsx)("p",{className:"text-sm",children:s.description}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsxs)("span",{children:["Current Votes (",i,")"]}),(0,a.jsxs)("span",{children:[l.toFixed(1),"% Yes"]})]}),(0,a.jsx)(eA,{value:l,className:"h-2"})]})]}),!n&&(0,a.jsxs)(D,{className:"flex justify-end gap-2",children:[(0,a.jsxs)(y,{variant:"outline",onClick:()=>t(s.id,"no"),disabled:!r,children:[(0,a.jsx)(sg.A,{className:"mr-2 h-4 w-4 text-red-500"}),"Reject"]}),(0,a.jsxs)(y,{onClick:()=>t(s.id,"yes"),disabled:!r,children:[(0,a.jsx)(e2.A,{className:"mr-2 h-4 w-4"}),"Approve"]})]})]})}let sN=[{id:"pii-detector",name:"PII Detector",description:"Detects and flags personally identifiable information",enabled:!0,severity:"high",category:"content",version:"1.2.0"},{id:"spam-filter",name:"Spam Filter",description:"Identifies and blocks spam content",enabled:!0,severity:"medium",category:"content",version:"2.1.0"},{id:"treasury-limit",name:"Treasury Limit Guard",description:"Prevents overspending from treasury",enabled:!0,severity:"critical",category:"economic",version:"0.9.0"}];class sw{static getInstance(){return sw.instance||(sw.instance=new sw),sw.instance}async getAllGuards(){return new Promise(e=>{setTimeout(()=>e(sN),500)})}constructor(){}}var sy=t(90232);function sk(){let[e,s]=(0,r.useState)([]),[t,n]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{let e=!0;return(async()=>{try{let t=sw.getInstance(),a=await t.getAllGuards();e&&(s(a),n(!1))}catch(s){console.error("Failed to load guards:",s),e&&n(!1)}})(),()=>{e=!1}},[]),(0,a.jsxs)(C,{className:"border-none shadow-sm",children:[(0,a.jsxs)(F,{children:[(0,a.jsxs)(_,{className:"flex items-center gap-2",children:[(0,a.jsx)(sy.A,{className:"h-5 w-5 text-blue-600"}),"v18 Security Guards"]}),(0,a.jsx)(E,{children:"Autonomous v18 agents ensuring deterministic compliance and economic safety."})]}),(0,a.jsx)(I,{children:(0,a.jsx)("div",{className:"space-y-4",children:t?(0,a.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground animate-pulse",children:[(0,a.jsx)("div",{className:"w-4 h-4 rounded-full bg-muted"}),(0,a.jsx)("span",{className:"text-sm",children:"Initializing guards..."})]}):0===e.length?(0,a.jsx)("div",{className:"text-muted-foreground text-sm italic",children:"No active guards found in current cluster."}):e.map(e=>(0,a.jsxs)("div",{className:"flex items-start justify-between p-4 border rounded-xl bg-muted/5 hover:bg-muted/10 transition-colors",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsx)("h4",{className:"font-bold text-sm",children:e.name}),(0,a.jsx)(A,{variant:"outline",className:"text-[10px] uppercase font-bold tracking-tighter h-5",children:e.version})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground leading-relaxed",children:e.description})]}),(0,a.jsx)("div",{className:"text-[10px] font-mono text-muted-foreground bg-muted px-2 py-1 rounded-md opacity-60",children:e.id})]},e.id))})})]})}function sS(e){let{children:s,title:t="Authentication Required",description:n="Connect your wallet to access this section."}=e,{isConnected:i}=(0,K.F)(),{isConnected:l,sessionToken:c,isLoading:d,error:m,triggerAuth:x}=M(),{openConnectModal:u}=(0,ea.Vx)();return((0,r.useEffect)(()=>{console.log("[AuthGate] State:",{wagmiConnected:i,authStoreConnected:l,hasToken:!!c,isLoading:d,error:m})},[i,l,c,d,m]),d)?(0,a.jsx)("div",{className:"flex items-center justify-center p-8 min-h-[400px]",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Verifying identity..."})]})}):i?i&&!c?(0,a.jsx)("div",{className:"flex items-center justify-center p-8 min-h-[400px]",children:(0,a.jsxs)(C,{className:"w-full max-w-md border-blue-500/30 bg-blue-500/5",children:[(0,a.jsxs)(F,{className:"text-center",children:[(0,a.jsx)(eI.A,{className:"h-12 w-12 mx-auto mb-4 text-blue-600 animate-pulse"}),(0,a.jsx)(_,{children:"Security Check Required"}),(0,a.jsx)(E,{children:"Please sign the challenge to verify your identity and unlock the dashboard."})]}),(0,a.jsxs)(I,{className:"space-y-4",children:[m&&(0,a.jsx)("p",{className:"text-sm text-red-600 text-center bg-red-50 p-2 rounded",children:m}),(0,a.jsx)(y,{onClick:()=>x(),className:"w-full font-bold shadow-lg",size:"lg",children:"Sign to Continue"}),(0,a.jsx)("p",{className:"text-xs text-center text-muted-foreground",children:"This signature is free and does not cost gas."})]})]})}):(console.log("[AuthGate] ✅ Unlocked"),(0,a.jsx)(a.Fragment,{children:s})):(0,a.jsx)("div",{className:"flex items-center justify-center p-8 min-h-[400px]",children:(0,a.jsxs)(C,{className:"w-full max-w-md",children:[(0,a.jsxs)(F,{className:"text-center",children:[(0,a.jsx)(o.A,{className:"h-12 w-12 mx-auto mb-4 text-blue-600"}),(0,a.jsx)(_,{children:t}),(0,a.jsx)(E,{children:n})]}),(0,a.jsx)(I,{className:"flex flex-col items-center gap-4",children:(0,a.jsx)(y,{onClick:()=>null==u?void 0:u(),className:"w-full",children:"Connect Wallet"})})]})})}var sA=t(84109);class sC extends r.Component{static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,s){console.error("Error in ".concat(this.props.name||"Component",":"),e,s)}render(){if(this.state.hasError){var e;return this.props.fallback?this.props.fallback:(0,a.jsxs)(C,{className:"border-destructive/50 bg-destructive/5 my-4",children:[(0,a.jsxs)(F,{children:[(0,a.jsxs)(_,{className:"flex items-center gap-2 text-destructive",children:[(0,a.jsx)(et.A,{className:"h-5 w-5"}),"Something went wrong"]}),(0,a.jsxs)(E,{children:["The ",this.props.name||"component"," failed to load properly."]})]}),(0,a.jsx)(I,{children:(0,a.jsx)("p",{className:"text-sm font-mono bg-destructive/10 p-2 rounded overflow-auto max-h-32",children:null==(e=this.state.error)?void 0:e.message})}),(0,a.jsx)(D,{children:(0,a.jsxs)(y,{variant:"outline",size:"sm",onClick:()=>this.setState({hasError:!1}),className:"gap-2",children:[(0,a.jsx)(sA.A,{className:"h-4 w-4"}),"Try again"]})})]})}return this.props.children}constructor(...e){super(...e),this.state={hasError:!1}}}var sF=t(26715),s_=t(5041);function sE(){let e=(0,sF.jE)(),{data:s=[],isLoading:t}=(0,i.I)({queryKey:["notifications"],queryFn:async()=>{let e=await fetch("/api/v18/notifications");if(!e.ok)throw Error("Failed to fetch notifications");return e.json()},refetchInterval:3e4}),r=(0,s_.n)({mutationFn:async()=>{let e=s.filter(e=>!e.read).map(e=>e.id),t=await fetch("/api/v18/notifications",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({notificationIds:e,action:"markRead"})});if(!t.ok)throw Error("Failed to mark as read");return t.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["notifications"]})}}),n=e=>{switch(e){case"reward":return(0,a.jsx)(o.A,{className:"h-4 w-4 text-green-500"});case"security":return(0,a.jsx)(u.A,{className:"h-4 w-4 text-blue-500"});case"system":return(0,a.jsx)(ez.A,{className:"h-4 w-4 text-purple-500"});default:return(0,a.jsx)(g.A,{className:"h-4 w-4 text-muted-foreground"})}};return(0,a.jsxs)(C,{className:"w-80 shadow-2xl border-primary/10 bg-card/95 backdrop-blur-md",children:[(0,a.jsx)(F,{className:"p-4 pb-2 border-b",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(_,{className:"text-sm font-bold flex items-center gap-2",children:[(0,a.jsx)(g.A,{className:"h-4 w-4"}),"Notifications"]}),(0,a.jsx)("button",{onClick:()=>{r.mutate()},className:"text-[10px] text-primary hover:underline font-semibold",children:"Mark all read"})]})}),(0,a.jsx)(I,{className:"p-0",children:(0,a.jsx)(z,{className:"h-80",children:(0,a.jsx)("div",{className:"divide-y divide-border",children:0===s.length?(0,a.jsx)("div",{className:"p-8 text-center text-muted-foreground",children:(0,a.jsx)("p",{className:"text-xs italic",children:"No new signals"})}):s.map(e=>(0,a.jsxs)("div",{className:(0,N.cn)("p-4 hover:bg-muted/50 transition-colors cursor-pointer relative",!e.read&&"bg-primary/[0.03]"),children:[!e.read&&(0,a.jsx)("div",{className:"absolute top-4 right-4 w-2 h-2 bg-blue-600 rounded-full"}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("div",{className:"mt-1",children:n(e.type)}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-xs font-bold leading-tight mb-1",children:e.title}),(0,a.jsx)("p",{className:"text-[11px] text-muted-foreground leading-snug line-clamp-2",children:e.message}),(0,a.jsxs)("div",{className:"flex items-center gap-1.5 mt-2",children:[(0,a.jsx)(eF.A,{className:"h-3 w-3 text-muted-foreground"}),(0,a.jsx)("span",{className:"text-[9px] text-muted-foreground uppercase font-medium",children:new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})]})]},e.id))})})}),(0,a.jsx)("div",{className:"p-2 border-t bg-muted/30 text-center",children:(0,a.jsx)("button",{className:"text-[10px] font-bold text-muted-foreground hover:text-foreground",children:"View Audit Ledger"})})]})}function sI(){var e,s;let{isConnected:t,address:v,sessionToken:b,isLoading:w}=M(),{balance:S,isLoading:D}=U();(0,n.useRouter)();let[L,T]=(0,r.useState)(!0),[P,K]=(0,r.useState)("home"),[V,G]=(0,r.useState)(!1),[W,B]=(0,r.useState)(""),[J,Q]=(0,r.useState)(!1);(0,r.useEffect)(()=>{},[t,w]);let X=[{id:"home",label:"Home",icon:l.A},{id:"spaces",label:"Spaces",icon:c.A},{id:"messages",label:"Messages",icon:d.A},{id:"wallet",label:"Wallet",icon:o.A},{id:"bounties",label:"Bounties",icon:m.A},{id:"ledger",label:"Ledger & Explain",icon:x.A},{id:"governance",label:"Governance",icon:u.A},{id:"settings",label:"Settings",icon:h.A}],{data:H={qfsStatus:"Loading...",coherenceRanking:"Loading...",guardSystem:"Loading...",ledgerSync:"Loading...",nodeHealth:"—"}}=(0,i.I)({queryKey:["systemHealth"],queryFn:async()=>{let e=await fetch("/api/v18/system/health");if(!e.ok)throw Error("Failed to fetch system health");return e.json()},refetchInterval:1e4}),{data:Y=[],isLoading:Z}=(0,i.I)({queryKey:["bounties"],queryFn:async()=>{let e=await fetch("/api/v18/bounties");if(!e.ok)throw Error("Failed to fetch bounties");return e.json()}}),{data:$=[],isLoading:ee}=(0,i.I)({queryKey:["ledger"],queryFn:async()=>{let e=await fetch("/api/v18/ledger");if(!e.ok)throw Error("Failed to fetch ledger");return e.json()},refetchInterval:5e3});if(w)return(0,a.jsx)("div",{className:"flex items-center justify-center h-screen bg-background",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-muted-foreground mb-4",children:"Synchronizing v18 clusters..."}),(0,a.jsx)(y,{variant:"outline",onClick:()=>window.location.reload(),className:"mr-2",children:"Reload"})]})});let es=v?"".concat(v.slice(0,6),"...").concat(v.slice(-4)):"Not Connected";return(0,a.jsxs)("div",{className:"flex h-screen bg-background text-foreground",children:[(0,a.jsxs)("div",{className:(0,N.cn)("flex flex-col border-r bg-card transition-all duration-300 shadow-xl z-20",L?"w-64":"w-20"),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,a.jsxs)("div",{className:(0,N.cn)("flex items-center gap-2",!L&&"hidden"),children:[(0,a.jsx)("img",{src:"/atlas-logo.png",alt:"ATLAS Logo",className:"w-8 h-8 rounded-lg shadow-lg object-cover"}),(0,a.jsx)("span",{className:"font-bold text-lg tracking-tight",children:"ATLAS v18"})]}),(0,a.jsx)(y,{variant:"ghost",size:"icon",onClick:()=>T(!L),children:L?(0,a.jsx)(p.A,{className:"h-5 w-5"}):(0,a.jsx)(j.A,{className:"h-5 w-5"})})]}),(0,a.jsx)(z,{className:"flex-1 px-3 py-4",children:(0,a.jsx)("nav",{className:"space-y-1",children:X.map(e=>{let s=e.icon;return(0,a.jsxs)("button",{"data-testid":"nav-".concat(e.id),onClick:()=>K(e.id),className:(0,N.cn)("flex items-center w-full transition-all duration-200 group relative","hover:bg-accent hover:text-accent-foreground rounded-lg px-3 py-2.5",P===e.id?"bg-primary/10 text-primary font-semibold":"text-muted-foreground",!L&&"justify-center"),children:[(0,a.jsx)(s,{className:(0,N.cn)("h-5 w-5",P===e.id?"text-primary":"group-hover:scale-110 transition-transform")}),L&&(0,a.jsx)("span",{className:"ml-3 text-sm",children:e.label}),P===e.id&&(0,a.jsx)("div",{className:"absolute left-0 w-1 h-6 bg-primary rounded-r-full"})]},e.id)})})}),(0,a.jsx)("div",{className:"p-4 border-t bg-muted/30",children:(0,a.jsxs)("div",{className:(0,N.cn)("flex items-center gap-3",!L&&"justify-center"),children:[(0,a.jsxs)(R,{className:"h-9 w-9 border-2 border-background shadow-sm",children:[(0,a.jsx)(q,{src:"/avatars/user.jpg"}),(0,a.jsx)(O,{className:"bg-primary/10 text-primary",children:"JD"})]}),L&&(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm font-semibold truncate",children:es}),t&&b&&(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),(0,a.jsxs)("p",{className:"text-[10px] uppercase font-bold text-muted-foreground tracking-wider",children:["Reputation: ",D?"...":(null==S||null==(e=S.reputation)?void 0:e.toFixed(0))||"0"]})]}),(!t||!b)&&(0,a.jsx)("p",{className:"text-[10px] uppercase font-bold text-muted-foreground tracking-wider",children:"Unverified Session"})]})]})})]}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col min-w-0",children:[(0,a.jsxs)("header",{className:"flex items-center justify-between p-4 border-b bg-card/80 backdrop-blur-md sticky top-0 z-10",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4 flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h2",{className:"text-lg font-bold capitalize",children:P.replace("-"," ")}),(0,a.jsx)(A,{variant:"outline",className:"bg-primary/5 text-primary border-primary/20 text-[10px] font-mono",children:"v18-ALPHA"})]}),(0,a.jsxs)("div",{className:"relative max-w-sm flex-1 hidden md:block",children:[(0,a.jsx)(f.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(k,{placeholder:"Search v18 clusters...",className:"pl-10 bg-muted/50 border-none h-9 focus-visible:ring-1",value:W,onChange:e=>B(e.target.value)})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 relative",children:[(0,a.jsxs)(y,{variant:"ghost",size:"icon",className:(0,N.cn)("relative cursor-pointer hover:bg-muted transition-colors",J&&"bg-muted"),onClick:()=>Q(!J),id:"notification-bell",children:[(0,a.jsx)(g.A,{className:"h-5 w-5"}),!J&&(0,a.jsx)("span",{className:"absolute top-1.5 right-1.5 w-2 h-2 bg-red-600 rounded-full border-2 border-card animate-pulse"})]}),J&&(0,a.jsx)("div",{className:"absolute top-full right-0 mt-2 z-50 animate-in fade-in zoom-in-95 duration-200 origin-top-right",children:(0,a.jsx)(sE,{})}),(0,a.jsx)("div",{className:"h-8 w-px bg-border mx-1"}),(0,a.jsx)(er,{})]})]}),(0,a.jsx)("main",{className:"flex-1 overflow-auto bg-gradient-to-b from-background to-muted/20",children:(0,a.jsxs)("div",{className:"max-w-6xl mx-auto p-6",children:[!t&&"settings"!==P&&(0,a.jsxs)(C,{className:"mb-6 border-blue-500/30 bg-blue-500/5 backdrop-blur-sm border-2",children:[(0,a.jsxs)(F,{children:[(0,a.jsxs)(_,{className:"flex items-center gap-2",children:[(0,a.jsx)(u.A,{className:"h-5 w-5 text-blue-600"}),"Authentication Required"]}),(0,a.jsx)(E,{children:"Connect your wallet to participate in the v18 Quantum Financial System. Wallets are used as cryptographic identity only. No transfers are supported."})]}),(0,a.jsx)(I,{children:(0,a.jsx)("div",{className:"flex items-center gap-4 p-4 bg-background/50 rounded-xl border border-blue-500/20",children:(0,a.jsxs)("p",{className:"text-sm text-balance",children:["Your v18 session will be sealed with ",(0,a.jsx)("strong",{children:"ASCON-128"})," authenticated encryption."]})})})]}),(0,a.jsx)("div",{className:"space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:(0,a.jsxs)(sC,{name:P,children:["home"===P&&(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,a.jsxs)("div",{className:"lg:col-span-2 space-y-8",children:[(0,a.jsxs)(C,{className:"overflow-hidden border-none shadow-sm group",children:[(0,a.jsx)("div",{className:"h-1 bg-gradient-to-r from-blue-500 via-indigo-500 to-purple-500"}),(0,a.jsxs)(F,{className:"pb-3 flex flex-row items-center gap-4",children:[(0,a.jsxs)(R,{className:"h-10 w-10",children:[(0,a.jsx)(q,{src:"/avatars/user.jpg"}),(0,a.jsx)(O,{children:"JD"})]}),(0,a.jsx)(k,{"data-testid":"composer-trigger",placeholder:"Share deterministic content...",className:"bg-muted/50 border-none h-11",onClick:()=>G(!0),readOnly:!0})]}),(0,a.jsxs)(I,{className:"flex justify-end gap-2 pt-0",children:[(0,a.jsx)(y,{variant:"outline",size:"sm",onClick:()=>G(!0),children:"Preview Economics"}),(0,a.jsx)(y,{size:"sm",onClick:()=>G(!0),children:"Publish Event"})]})]}),(0,a.jsx)(e4,{})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(sx,{}),(0,a.jsxs)(C,{className:"border-none shadow-sm",children:[(0,a.jsx)(F,{children:(0,a.jsxs)(_,{className:"text-sm font-bold flex items-center gap-2",children:[(0,a.jsx)(m.A,{className:"h-4 w-4 text-primary"}),"System Health"]})}),(0,a.jsx)(I,{className:"space-y-4",children:Object.entries(H).map(e=>{let[s,t]=e;return(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-xs text-muted-foreground capitalize",children:s.replace(/([A-Z])/g," $1").trim()}),(0,a.jsx)(A,{variant:"Operational"===t||"Active"===t||"All Green"===t?"default":"secondary",className:"text-[10px] h-5",children:t})]},s)})})]}),t&&(0,a.jsxs)(C,{className:"border-none shadow-sm bg-gradient-to-br from-indigo-600 to-blue-700 text-white",children:[(0,a.jsx)(F,{children:(0,a.jsx)(_,{className:"text-sm",children:"Total Internal Credits"})}),(0,a.jsxs)(I,{children:[(0,a.jsxs)("div",{className:"text-3xl font-bold tracking-tight",children:[D?"...":(null==S||null==(s=S.balance)?void 0:s.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}))||"0.00"," FLX"]}),(0,a.jsx)("p",{className:"text-[10px] mt-2 opacity-80 uppercase font-bold tracking-wider",children:"Non-Transferable (v18 Plan)"})]})]})]})]}),"spaces"===P&&(0,a.jsx)(sS,{title:"Spaces Portal Locked",description:"Connect your wallet to explore v18 spaces and clusters.",children:(0,a.jsx)(sa,{})}),"messages"===P&&(0,a.jsx)(sS,{title:"Secure Messaging Locked",description:"An authenticated session is required to access end-to-end encrypted messages.",children:(0,a.jsx)(eX,{})}),"bounties"===P&&(0,a.jsx)(sS,{title:"Bounty Dashboard Locked",description:"Verify your identity to claim development bounties and earn QFS rewards.",children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold",children:"Available Bounties"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Contribute to QFS development and earn real FLX rewards."})]}),(0,a.jsxs)(A,{variant:"outline",className:"h-6",children:[(null==Y?void 0:Y.length)||0," active"]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Z?(0,a.jsx)("div",{className:"col-span-2 flex justify-center py-12",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):0===Y.length?(0,a.jsx)(C,{className:"col-span-2 border-dashed",children:(0,a.jsx)(I,{className:"py-12 text-center text-muted-foreground",children:"No active bounties found in your cluster."})}):Y.map(e=>(0,a.jsxs)(C,{className:"group hover:border-primary/50 transition-colors",children:[(0,a.jsxs)(F,{className:"pb-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsx)(A,{variant:"secondary",className:"mb-2 uppercase text-[10px] tracking-wider",children:e.type}),(0,a.jsxs)("div",{className:"text-lg font-bold text-green-600",children:[e.reward," FLX"]})]}),(0,a.jsx)(_,{className:"text-base group-hover:text-primary transition-colors",children:e.title}),(0,a.jsx)(E,{className:"line-clamp-2",children:e.description})]}),(0,a.jsx)(I,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(A,{variant:"Hard"===e.difficulty?"destructive":"Medium"===e.difficulty?"default":"outline",className:"text-[10px]",children:e.difficulty}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:e.status})]}),(0,a.jsx)(y,{size:"sm",children:"Claim Bounty"})]})})]},e.id))})]})}),"governance"===P&&(0,a.jsx)(sS,{title:"Governance Portal Locked",description:"QFS token holders only. Connect wallet to vote on protocol upgrades.",children:(0,a.jsx)(sv,{})}),"ledger"===P&&(0,a.jsx)(sS,{title:"Deterministic Ledger Locked",description:"Cryptographic proof of participation is required to view the event stream.",children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(en,{}),(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold",children:"Deterministic Ledger"}),(0,a.jsx)("p",{className:"text-muted-foreground text-sm",children:"ASCON-sealed audit trail of v18 cluster events."})]}),(0,a.jsxs)(A,{variant:"outline",className:"text-green-600 border-green-200",children:[$.length," events synced"]})]}),(0,a.jsx)("div",{className:"space-y-3",children:ee?(0,a.jsx)("div",{className:"flex justify-center py-12",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):0===$.length?(0,a.jsx)(C,{className:"border-dashed py-12 flex items-center justify-center text-muted-foreground",children:"No events found in the current term."}):$.map(e=>(0,a.jsx)(C,{className:"border-none shadow-sm hover:bg-accent/5 transition-colors group",children:(0,a.jsxs)(I,{className:"p-4 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"h-10 w-10 rounded-lg bg-primary/10 flex items-center justify-center",children:(0,a.jsx)(x.A,{className:"h-5 w-5 text-primary"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-mono text-sm font-bold tracking-tight",children:e.type}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-[10px] text-muted-foreground mt-1",children:[(0,a.jsx)("span",{children:new Date(e.timestamp).toLocaleTimeString()}),(0,a.jsx)("span",{children:"•"}),(0,a.jsx)("span",{className:"font-mono",children:e.id}),(0,a.jsx)("span",{children:"•"}),(0,a.jsx)("span",{className:"truncate max-w-[100px]",children:e.payload_hash})]})]})]}),(0,a.jsx)(A,{variant:"ASCON_SEALED"===e.status?"default":"secondary",className:"text-[10px]",children:e.status})]})},e.id))})]})}),"wallet"===P&&(0,a.jsx)(sS,{title:"Wallet Interface Locked",description:"Authenticate to view your QFS internal credit balance and history.",children:(0,a.jsx)(sr,{})}),"settings"===P&&(0,a.jsx)(sS,{title:"Identity Settings Locked",description:"Verify session to manage your v18 profile and guard configuration.",children:(0,a.jsxs)("div",{className:"space-y-12",children:[(0,a.jsx)(sp,{}),(0,a.jsx)(sk,{})]})})]})})]})})]}),V&&(0,a.jsx)(eM,{isOpen:V,onClose:()=>G(!1)})]})}},59434:(e,s,t)=>{"use strict";t.d(s,{cn:()=>n});var a=t(52596),r=t(39688);function n(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,r.QP)((0,a.$)(s))}},86777:(e,s,t)=>{Promise.resolve().then(t.bind(t,40033))}},e=>{var s=s=>e(e.s=s);e.O(0,[8451,4134,9070,7785,8441,1684,7358],()=>s(86777)),_N_E=e.O()}]);