"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3688],{13688:function(e,t,r){r.r(t),r.d(t,{default:function(){return p}});var n=r(57437),a=r(2265),i=r(79820),o=r(12381),l=r(40279),s=r(75060),c=r(23675),d=r(27515),u=r(86899),f=r(88564);function p(){let{did:e}=(0,d.a)(),{updateProfile:t,isUpdating:r}=function(){let{did:e}=(0,d.a)(),[t,r]=(0,a.useState)(!1);return{updateProfile:async t=>{if(!e){console.error("No identity found");return}r(!0);try{let r=await (0,f.g_)(t),n=crypto.randomUUID(),a={eventType:"ProfileUpdated",pendingId:n,actorDID:e,inputs:t,eventInputHash:r,createdAtMs:Date.now(),status:"pending"},i=await (0,u.X)();return await i.save(a),console.log("[Profile] Submitted update for ".concat(e)),n}catch(e){throw console.error("Failed to update profile:",e),e}finally{r(!1)}},isUpdating:t}}(),[p,v]=(0,a.useState)(""),[g,y]=(0,a.useState)(""),[m,b]=(0,a.useState)(""),h=async r=>{if(r.preventDefault(),!e)return;let n=await t({name:p||void 0,bio:g||void 0,avatar:m||void 0});alert("Profile update submitted to local pending store! (ID: ".concat(n,")"))};return(0,n.jsxs)(i.Zb,{children:[(0,n.jsxs)(i.Ol,{children:[(0,n.jsx)(i.ll,{children:"Edit Profile"}),(0,n.jsxs)(i.SZ,{children:["Updates are recorded on the public ledger for transparency. DID: ",e?"".concat(e.slice(0,16),"..."):"Not connected"]})]}),(0,n.jsx)(i.aY,{children:(0,n.jsxs)("form",{onSubmit:h,className:"space-y-4",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(s._,{htmlFor:"name",children:"Display Name"}),(0,n.jsx)(l.I,{id:"name",placeholder:"Enter your public name",value:p,onChange:e=>v(e.target.value)})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(s._,{htmlFor:"bio",children:"Bio"}),(0,n.jsx)(c.g,{id:"bio",placeholder:"Tell the network about yourself",value:g,onChange:e=>y(e.target.value)})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(s._,{htmlFor:"avatar",children:"Avatar CID / URL"}),(0,n.jsx)(l.I,{id:"avatar",placeholder:"ipfs://... or https://...",value:m,onChange:e=>b(e.target.value)})]}),(0,n.jsx)(o.z,{type:"submit",disabled:r,children:r?"Submitting...":"Update Profile"})]})})]})}},79820:function(e,t,r){r.d(t,{Ol:function(){return o},SZ:function(){return s},Zb:function(){return i},aY:function(){return c},eW:function(){return d},ll:function(){return l}});var n=r(57437);r(2265);var a=r(93448);function i(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card",className:(0,a.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...r})}function o(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card-header",className:(0,a.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...r})}function l(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card-title",className:(0,a.cn)("leading-none font-semibold",t),...r})}function s(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card-description",className:(0,a.cn)("text-muted-foreground text-sm",t),...r})}function c(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card-content",className:(0,a.cn)("px-6",t),...r})}function d(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card-footer",className:(0,a.cn)("flex items-center px-6 [.border-t]:pt-6",t),...r})}},75060:function(e,t,r){r.d(t,{_:function(){return o}});var n=r(57437);r(2265);var a=r(370),i=r(93448);function o(e){let{className:t,...r}=e;return(0,n.jsx)(a.f,{"data-slot":"label",className:(0,i.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...r})}},23675:function(e,t,r){r.d(t,{g:function(){return i}});var n=r(57437);r(2265);var a=r(93448);function i(e){let{className:t,...r}=e;return(0,n.jsx)("textarea",{"data-slot":"textarea",className:(0,a.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...r})}},27515:function(e,t,r){r.d(t,{a:function(){return c}});var n=r(2265),a=r(82957).Buffer;async function i(){let e=await crypto.subtle.generateKey({name:"ECDSA",namedCurve:"P-256"},!0,["sign","verify"]),t=await crypto.subtle.exportKey("raw",e.publicKey),r=await crypto.subtle.exportKey("pkcs8",e.privateKey),n=new Uint8Array(t),i=new Uint8Array(r),o=a.from(n).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"");return{publicKey:n,privateKey:i,did:"did:key:".concat(o)}}let o="atlas_identity_v1";function l(e){if(e.length%2!=0)throw Error("Invalid hex string");let t=new Uint8Array(e.length/2);for(let r=0;r<e.length;r+=2)t[r/2]=parseInt(e.substring(r,r+2),16);return t}function s(e){return Array.from(e).map(e=>e.toString(16).padStart(2,"0")).join("")}function c(){let[e,t]=(0,n.useState)({did:null,privateKey:null,publicKey:null,isAuthenticated:!1,isLoading:!0,error:null});(0,n.useEffect)(()=>{r()},[]);let r=async()=>{try{let e=localStorage.getItem(o);if(e){let r=JSON.parse(e);t({did:r.did,privateKey:l(r.privateKey),publicKey:l(r.publicKey),isAuthenticated:!0,isLoading:!1,error:null})}else{let e=await i(),r={did:e.did,privateKey:s(e.privateKey),publicKey:s(e.publicKey)};localStorage.setItem(o,JSON.stringify(r)),t({did:e.did,privateKey:e.privateKey,publicKey:e.publicKey,isAuthenticated:!0,isLoading:!1,error:null})}}catch(e){console.error("Failed to load identity:",e),t(t=>({...t,isLoading:!1,error:e}))}};return{...e,logout:()=>{localStorage.removeItem(o),t({did:null,privateKey:null,publicKey:null,isAuthenticated:!1,isLoading:!1,error:null})}}}},86899:function(e,t,r){r.d(t,{X:function(){return a}});class n{static getInstance(){return n.instance||(n.instance=new n),n.instance}init(){}add(e){this.events.set(e.id,e)}get(e){return this.events.get(e)}getAll(){return Array.from(this.events.values())}remove(e){this.events.delete(e)}clear(){this.events.clear()}constructor(){this.events=new Map}}function a(){return n.getInstance()}},88564:function(e,t,r){async function n(e){return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",e))).map(e=>e.toString(16).padStart(2,"0")).join("")}async function a(e){let t=function e(t){if("object"!=typeof t||null===t)return JSON.stringify(t);if(Array.isArray(t))return"[".concat(t.map(e).join(","),"]");let r=Object.keys(t).sort().filter(e=>void 0!==t[e]).map(r=>'"'.concat(r,'":').concat(e(t[r])));return"{".concat(r.join(","),"}")}(e);return n(new TextEncoder().encode(t))}r.d(t,{g_:function(){return a}})},370:function(e,t,r){r.d(t,{f:function(){return s}});var n=r(2265);r(54887);var a=r(37053),i=r(57437),o=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=(0,a.Z8)(`Primitive.${t}`),o=n.forwardRef((e,n)=>{let{asChild:a,...o}=e,l=a?r:t;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,i.jsx)(l,{...o,ref:n})});return o.displayName=`Primitive.${t}`,{...e,[t]:o}},{}),l=n.forwardRef((e,t)=>(0,i.jsx)(o.label,{...e,ref:t,onMouseDown:t=>{var r;t.target.closest("button, input, select, textarea")||(null===(r=e.onMouseDown)||void 0===r||r.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));l.displayName="Label";var s=l}}]);